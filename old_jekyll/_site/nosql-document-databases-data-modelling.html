<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" nosql">
<title>Data modelling | Data Management</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-custom.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="data-management" href="http://localhost:4000/feed.xml">

<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$'] ],
    processEscapes: true,
  }
});
MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
	  alert("Math Processing Error: "+message[1]);
	});
MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
	  alert("Math Processing Error: "+message[1]);
	});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Data Management</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/vda-lab/data-management" target="_blank" rel="noopener">GitHub</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="rdbms_landing_page.html">Relational databases and SQL</a></li>
                        
                        
                        
                        <li><a href="nosql_landing_page.html">NoSQL</a></li>
                        
                        
                        
                        <li><a href="lambda_landing_page.html">Lambda architecture</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Data modelling">{title}</a></li>',
                    noResultsText: '',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">NoSQL databases </li>
  
  
  
      
  
      
  
  <li>
      <a title="Issues with relational databases" href="#">Issues with relational databases</a>
      <ul>
          
          
          
          <li><a title="Scalability and clusters" href="nosql-scalability-and-clusters.html">Scalability and clusters</a></li>
          
          
          
          
          
          
          <li><a title="Impedance mismatch" href="nosql-impedance-mismatch.html">Impedance mismatch</a></li>
          
          
          
          
          
          
          <li><a title="Relational data" href="nosql-relational-data.html">Relational data</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="General NoSQL concepts" href="#">General NoSQL concepts</a>
      <ul>
          
          
          
          <li><a title="General NoSQL concepts" href="nosql-general-concepts.html">General NoSQL concepts</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Intermezzo - JSON" href="#">Intermezzo - JSON</a>
      <ul>
          
          
          
          <li><a title="Intermezzo - JSON" href="nosql-intermezzo-json.html">Intermezzo - JSON</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Key/value stores" href="#">Key/value stores</a>
      <ul>
          
          
          
          <li><a title="Key/value stores" href="nosql-keyvalue-stores.html">Key/value stores</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Document-oriented databases" href="#">Document-oriented databases</a>
      <ul>
          
          
          
          <li><a title="Introduction" href="nosql-document-databases-introduction.html">Introduction</a></li>
          
          
          
          
          
          
          <li><a title="Concepts" href="nosql-document-databases-concepts.html">Concepts</a></li>
          
          
          
          
          
          
          <li class="active"><a title="Data modelling" href="nosql-document-databases-data-modelling.html">Data modelling</a></li>
          
          
          
          
          
          
          <li><a title="Data modelling patterns" href="nosql-document-databases-data-modelling-patterns.html">Data modelling patterns</a></li>
          
          
          
          
          
          
          <li><a title="Difference with key/value stores" href="nosql-difference-with-keyvalue-stores.html">Difference with key/value stores</a></li>
          
          
          
          
          
          
          <li><a title="Implementations" href="nosql-document-databases-implementations.html">Implementations</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Graph databases" href="#">Graph databases</a>
      <ul>
          
          
          
          <li><a title="Introduction" href="nosql-graph-databases-introduction.html">Introduction</a></li>
          
          
          
          
          
          
          <li><a title="Nomenclature" href="nosql-graph-databases-nomenclature.html">Nomenclature</a></li>
          
          
          
          
          
          
          <li><a title="Centralities" href="nosql-graph-databases-centralities.html">Centralities</a></li>
          
          
          
          
          
          
          <li><a title="Graph mining" href="nosql-graph-databases-mining.html">Graph mining</a></li>
          
          
          
          
          
          
          <li><a title="Data modelling" href="nosql-graph-databases-data-modelling.html">Data modelling</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="ArangoDB" href="#">ArangoDB</a>
      <ul>
          
          
          
          <li><a title="A multi-model database" href="nosql-arangodb-multimodel-database.html">A multi-model database</a></li>
          
          
          
          
          
          
          <li><a title="Starting with ArangoDB" href="nosql-starting-with-arangodb.html">Starting with ArangoDB</a></li>
          
          
          
          
          
          
          <li><a title="Loading data" href="nosql-arangodb-loading-data.html">Loading data</a></li>
          
          
          
          
          
          
          <li><a title="Querying key/value data" href="nosql-arangodb-querying-keyvalue-data.html">Querying key/value data</a></li>
          
          
          
          
          
          
          <li><a title="Querying document data" href="nosql-arangodb-querying-document-data.html">Querying document data</a></li>
          
          
          
          
          
          
          <li><a title="Querying graph data" href="nosql-arangodb-querying-graph-data.html">Querying graph data</a></li>
          
          
          
          
          
          
          <li><a title="Improving performance" href="nosql-arangodb-improving-performance.html">Improving performance</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="ArangoDB APIs" href="#">ArangoDB APIs</a>
      <ul>
          
          
          
          <li><a title="APIs" href="nosql-arangodb-apis.html">APIs</a></li>
          
          
          
          
          
          
          <li><a title="ArangoDB and R" href="nosql-arangodb-and-r.html">ArangoDB and R</a></li>
          
          
          
          
          
          
          <li><a title="ArangoDB and python" href="nosql-arangodb-and-python.html">ArangoDB and python</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block: -->
         <!-- <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p> -->

</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Data modelling</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

   <!-- see https://www.youtube.com/watch?v=yuPjoC3jmPA -->

<div class="seriesContext">
  
  
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      
      
  
  

  
    <a href="nosql-document-databases-concepts.html"><button type="button" class="btn btn-primary">Previous: Concepts</button></a>
  
</div>

<h2 id="think-about-how-you-will-use-the-data">Think about how you will use the data</h2>
<p>The starting point for modelling your data is different between an RDBMS and a document database. With an RDBMS, you typically start from the <em>data</em>; with a document database, you typically start from the <em>application</em>.</p>

<p>Think about how we will use the data, and how they will be accessed. Consider, for example, a movie dataset with actors and movies. For each actor we have their name , date of birth and the movies they acted in. For each movie, we have the title, release year, and tagline. There are different ways in which we can model this data in a document database, depending on what the intended use will be. So what do you want to <em>do</em> with this data? Do you want to answer questions about the actors? Or about the movies?</p>

<p>So the two obvious approaches are <em>movie-centric</em></p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">movie:</span><span class="w"> </span><span class="s2">"As Good As It Gets"</span><span class="p">,</span><span class="w">
  </span><span class="err">released:</span><span class="w"> </span><span class="mi">1997</span><span class="p">,</span><span class="w">
  </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"A comedy from the heart that goes for the throat"</span><span class="p">,</span><span class="w">
  </span><span class="err">actors:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Jack Nicholson"</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1937</span><span class="w"> </span><span class="p">},</span><span class="w">
           </span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Cuba Gooding Jr."</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1968</span><span class="w"> </span><span class="p">},</span><span class="w">
           </span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Helen Hunt"</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1963</span><span class="w"> </span><span class="p">},</span><span class="w">
           </span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Greg Kinnear"</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1963</span><span class="w"> </span><span class="p">}]}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">movie:</span><span class="w"> </span><span class="s2">"A Few Good Men"</span><span class="p">,</span><span class="w">
  </span><span class="err">released:</span><span class="w"> </span><span class="mi">1992</span><span class="p">,</span><span class="w">
  </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"In the heart of the nation's capital, ..."</span><span class="p">,</span><span class="w">
  </span><span class="err">actors:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Jack Nicholson"</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1937</span><span class="w"> </span><span class="p">},</span><span class="w">
           </span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Demi Moore"</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1962</span><span class="w"> </span><span class="p">},</span><span class="w">
           </span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Cuba Gooding Jr."</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1968</span><span class="w"> </span><span class="p">},</span><span class="w">
           </span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Tom Cruise"</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1962</span><span class="w"> </span><span class="p">}]}</span></code></pre></figure>

<p>or <em>actor-centric</em>:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Jack Nicholson"</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1937</span><span class="p">,</span><span class="w">
  </span><span class="err">movies:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"As Good As It Gets"</span><span class="p">,</span><span class="w"> </span><span class="err">released:</span><span class="w"> </span><span class="mi">1997</span><span class="p">,</span><span class="w">
             </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"A comedy from the heart that goes for the throat"</span><span class="w"> </span><span class="p">},</span><span class="w">
           </span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"A Few Good Men"</span><span class="p">,</span><span class="w"> </span><span class="err">released:</span><span class="w"> </span><span class="mi">1992</span><span class="p">,</span><span class="w">
             </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"In the heart of the nation's capital, ..."</span><span class="p">}]}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Cuba Gooding Jr."</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1968</span><span class="p">,</span><span class="w">
  </span><span class="err">movies:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"As Good As It Gets"</span><span class="p">,</span><span class="w"> </span><span class="err">released:</span><span class="w"> </span><span class="mi">1997</span><span class="p">,</span><span class="w">
             </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"A comedy from the heart that goes for the throat"</span><span class="w"> </span><span class="p">},</span><span class="w">
           </span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"A Few Good Men"</span><span class="p">,</span><span class="w"> </span><span class="err">released:</span><span class="w"> </span><span class="mi">1992</span><span class="p">,</span><span class="w">
             </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"In the heart of the nation's capital, ..."</span><span class="p">},</span><span class="w">
           </span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"What Dreams May Come"</span><span class="p">,</span><span class="w"> </span><span class="err">released:</span><span class="w"> </span><span class="mi">1998</span><span class="p">,</span><span class="w">
             </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"After life there is more. The end is just the beginning."</span><span class="p">}]}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Tom Cruise"</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1962</span><span class="p">,</span><span class="w">
  </span><span class="err">movies:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"A Few Good Men"</span><span class="p">,</span><span class="w"> </span><span class="err">released:</span><span class="w"> </span><span class="mi">1992</span><span class="p">,</span><span class="w">
             </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"In the heart of the nation's capital, ..."</span><span class="p">},</span><span class="w">
           </span><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Jerry Maguire"</span><span class="p">,</span><span class="w"> </span><span class="err">released:</span><span class="w"> </span><span class="mi">2000</span><span class="p">,</span><span class="w">
             </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"The rest of his life begins now."</span><span class="p">}]}</span></code></pre></figure>

<p>Searching using an actor-centric query in a movie-centric database will be very inefficient. If we want to know in how movies Jack Nicholson played using the first approach above, we have to go through <em>all</em> documents and check which has him mentioned in the list of actors. Using the second approach above, we only have to get the single document about him and we have all the information.</p>

<p>Another option is to use <em>links</em> or <em>references</em>. The <code class="language-plaintext highlighter-rouge">actors</code> collection could then be:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">_key:</span><span class="w"> </span><span class="s2">"JNich"</span><span class="p">,</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Jack Nicholson"</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1937</span><span class="p">,</span><span class="w">
                 </span><span class="err">movies</span><span class="w"> </span><span class="p">[</span><span class="s2">"AGAIG"</span><span class="p">,</span><span class="s2">"AFGM"</span><span class="p">]}</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">_key:</span><span class="w"> </span><span class="s2">"TCrui"</span><span class="p">,</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Tom Cruise"</span><span class="p">,</span><span class="w"> </span><span class="err">born:</span><span class="w"> </span><span class="mi">1962</span><span class="p">,</span><span class="w">
                 </span><span class="err">movies:</span><span class="w"> </span><span class="p">[</span><span class="s2">"AFGM"</span><span class="p">,</span><span class="s2">"JM"</span><span class="p">]}</span></code></pre></figure>

<p>and the <code class="language-plaintext highlighter-rouge">movies</code> collection:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">_key:</span><span class="w"> </span><span class="s2">"AGAIG"</span><span class="p">,</span><span class="w"> </span><span class="err">title:</span><span class="w"> </span><span class="s2">"As Good As It Gets"</span><span class="p">,</span><span class="w"> </span><span class="err">release:</span><span class="w"> </span><span class="mi">1997</span><span class="p">,</span><span class="w">
                </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"A comedy from the heart that goes for the throat"</span><span class="p">,</span><span class="w">
                </span><span class="err">actors:</span><span class="w"> </span><span class="p">[</span><span class="s2">"JNich"</span><span class="p">,</span><span class="w"> </span><span class="s2">"CGood"</span><span class="p">,</span><span class="w"> </span><span class="s2">"HHunt"</span><span class="p">,</span><span class="w"> </span><span class="s2">"GKinn"</span><span class="p">]}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">_key:</span><span class="w"> </span><span class="s2">"AFGM"</span><span class="p">,</span><span class="w"> </span><span class="err">title:</span><span class="w"> </span><span class="s2">"A Few Good Men"</span><span class="p">,</span><span class="w"> </span><span class="err">release:</span><span class="w"> </span><span class="mi">1992</span><span class="p">,</span><span class="w">
                </span><span class="err">tagline:</span><span class="w"> </span><span class="s2">"In the heart of the nation's capital, ..."</span><span class="p">,</span><span class="w">
                </span><span class="err">actors:</span><span class="w"> </span><span class="p">[</span><span class="s2">"JNich"</span><span class="p">,</span><span class="w"> </span><span class="s2">"DMoor"</span><span class="p">,</span><span class="w"> </span><span class="s2">"CGood"</span><span class="p">,</span><span class="w"> </span><span class="s2">"TCrui"</span><span class="p">]}</span></code></pre></figure>

<p>In this case the <code class="language-plaintext highlighter-rouge">movies</code> or <code class="language-plaintext highlighter-rouge">actors</code> key in the document refers to the <code class="language-plaintext highlighter-rouge">_key</code> in the other collection.</p>

<p>The above are just some of the ways to model your data. Below, we’ll go deeper into how you can approach different types of relationships between documents.</p>

<h2 id="relationships-between-documents">Relationships between documents</h2>
<p>So when do you embed, and when do you reference?</p>

<!-- check https://www.youtube.com/embed/leNCfU5SYR8?version=3&rel=1&fs=1&autohide=2&showsearch=0&showinfo=1&iv_load_policy=1&wmode=transparent -->

<h3 id="1-to-1-relationships">1-to-1 relationships</h3>
<p>If you have a 1-to-1 relationship, just add a key-value pair in the document. For example, an individual having only a single twitter account would just have that account added as a key-value pair:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Elon Musk"</span><span class="p">,</span><span class="w">
  </span><span class="err">born:</span><span class="w"> </span><span class="mi">1971</span><span class="p">,</span><span class="w">
  </span><span class="err">twitter:</span><span class="w"> </span><span class="s2">"@elonmusk"</span><span class="w"> </span><span class="p">}</span></code></pre></figure>

<p><img src="/assets/musk_twitter.png" alt="" /></p>

<h3 id="1-to-few-relationships">1-to-few relationships</h3>
<p>If you have a 1-to-few relationship (i.e. a 1-to-many where the “many” is not “too many”), it’s easiest to <em>embed</em> the information in a list. For example for Elon Musk’s citizenships:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Elon Musk"</span><span class="p">,</span><span class="w">
  </span><span class="err">born:</span><span class="w"> </span><span class="mi">1971</span><span class="p">,</span><span class="w">
  </span><span class="err">twitter:</span><span class="w"> </span><span class="s2">"@elonmusk"</span><span class="p">,</span><span class="w">
  </span><span class="err">citizenships:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">country:</span><span class="w"> </span><span class="s2">"South Africa"</span><span class="p">,</span><span class="w"> </span><span class="err">since:</span><span class="w"> </span><span class="mi">1971</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">country:</span><span class="w"> </span><span class="s2">"Canada"</span><span class="p">,</span><span class="w"> </span><span class="err">since:</span><span class="w"> </span><span class="mi">1971</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">country:</span><span class="w"> </span><span class="s2">"USA"</span><span class="p">,</span><span class="w"> </span><span class="err">since:</span><span class="w"> </span><span class="mi">2002</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">]}</span></code></pre></figure>

<h3 id="1-to-many-relationships">1-to-many relationships</h3>
<p>The above works as long as you don’t have thousands of elements in such an array. Consider a car; which apparently on average consists of 30,000 parts. We don’t want to store all information for each parts in a huge array. Because each element in that array will have information like it’s name, number, cost, provider, how many we need, etc. In this case, we can choose to use <em>references</em> instead of embedding.</p>

<p><img src="/assets/carparts.jpg" alt="" /></p>

<p><code class="language-plaintext highlighter-rouge">cars</code> collection:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">_key:</span><span class="w"> </span><span class="s2">"car1"</span><span class="p">,</span><span class="w">
  </span><span class="err">name:</span><span class="w"> </span><span class="s2">"left-handed Tesla Model S"</span><span class="p">,</span><span class="w">
  </span><span class="err">manufacturer:</span><span class="w"> </span><span class="s2">"Tesla"</span><span class="p">,</span><span class="w">
  </span><span class="err">catalog_number:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
  </span><span class="err">parts:</span><span class="w"> </span><span class="p">[</span><span class="s2">"p1"</span><span class="p">,</span><span class="s2">"p3"</span><span class="p">,</span><span class="s2">"p17"</span><span class="p">,</span><span class="err">...</span><span class="p">]}</span></code></pre></figure>

<p><code class="language-plaintext highlighter-rouge">parts</code> collection:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">_key:</span><span class="w"> </span><span class="s2">"p1"</span><span class="p">,</span><span class="w">
  </span><span class="err">partno:</span><span class="w"> </span><span class="s2">"123-ABC-987"</span><span class="p">,</span><span class="w">
  </span><span class="err">name:</span><span class="w"> </span><span class="s2">"nr 4 bolt"</span><span class="p">,</span><span class="w">
  </span><span class="err">qty:</span><span class="w"> </span><span class="mi">105</span><span class="p">,</span><span class="w">
  </span><span class="err">cost:</span><span class="w"> </span><span class="mf">0.54</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">_key:</span><span class="w"> </span><span class="s2">"p3"</span><span class="p">,</span><span class="w">
  </span><span class="err">partno:</span><span class="w"> </span><span class="s2">"826-CKW-732"</span><span class="p">,</span><span class="w">
  </span><span class="err">name:</span><span class="w"> </span><span class="s2">"nr 6 grommet"</span><span class="p">,</span><span class="w">
  </span><span class="err">qty:</span><span class="w"> </span><span class="mi">68</span><span class="p">,</span><span class="w">
  </span><span class="err">cost:</span><span class="w"> </span><span class="mf">0.52</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="err">...</span></code></pre></figure>

<h3 id="1-to-immense-relationships">1-to-immense relationships</h3>
<p>This works fine, until you’re in the situation where you have a huge number of elements. You should <em>never</em> use an array that is basically unbounded, so that grows really big. For example, think about sensors that store information every second, or server logs.</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"server_17"</span><span class="p">,</span><span class="w">
  </span><span class="err">location:</span><span class="w"> </span><span class="s2">"server room 2"</span><span class="p">,</span><span class="w">
  </span><span class="err">messages:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:29"</span><span class="p">,</span><span class="w">
      </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:35"</span><span class="p">,</span><span class="w">
      </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:37"</span><span class="p">,</span><span class="w">
      </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:39"</span><span class="p">,</span><span class="w">
      </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:39"</span><span class="p">,</span><span class="w">
      </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:42"</span><span class="p">,</span><span class="w">
      </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:39"</span><span class="p">,</span><span class="w">
      </span><span class="err">message:</span><span class="w"> </span><span class="s2">"Failed to bootstrap path  /System/Library, error = 2: No such file or directory"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:43"</span><span class="p">,</span><span class="w">
      </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]}</span></code></pre></figure>

<p>A better approach here is to use a <em>reverse reference</em>, where the <em>host</em> is referenced. That brings the log messages themselves first-grade documents.</p>

<p><code class="language-plaintext highlighter-rouge">servers</code> collection:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"server_17"</span><span class="p">,</span><span class="w">
  </span><span class="err">location:</span><span class="w"> </span><span class="s2">"server room 2"</span><span class="w"> </span><span class="p">}</span></code></pre></figure>

<p><code class="language-plaintext highlighter-rouge">logs</code> collections:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:29"</span><span class="p">,</span><span class="w"> </span><span class="err">host:</span><span class="w"> </span><span class="s2">"server_17"</span><span class="p">,</span><span class="w">
  </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:35"</span><span class="p">,</span><span class="w"> </span><span class="err">host:</span><span class="w"> </span><span class="s2">"server_17"</span><span class="p">,</span><span class="w">
  </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:37"</span><span class="p">,</span><span class="w"> </span><span class="err">host:</span><span class="w"> </span><span class="s2">"server_17"</span><span class="p">,</span><span class="w">
  </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:39"</span><span class="p">,</span><span class="w"> </span><span class="err">host:</span><span class="w"> </span><span class="s2">"server_17"</span><span class="p">,</span><span class="w">
  </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:39"</span><span class="p">,</span><span class="w"> </span><span class="err">host:</span><span class="w"> </span><span class="s2">"server_17"</span><span class="p">,</span><span class="w">
  </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:42"</span><span class="p">,</span><span class="w"> </span><span class="err">host:</span><span class="w"> </span><span class="s2">"server_17"</span><span class="p">,</span><span class="w">
  </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:39"</span><span class="p">,</span><span class="w"> </span><span class="err">host:</span><span class="w"> </span><span class="s2">"server_17"</span><span class="p">,</span><span class="w">
  </span><span class="err">message:</span><span class="w"> </span><span class="s2">"Failed to bootstrap path  /System/Library, error = 2: No such file or directory"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">date:</span><span class="w"> </span><span class="s2">"Oct 14 07:50:43"</span><span class="p">,</span><span class="w"> </span><span class="err">host:</span><span class="w"> </span><span class="s2">"server_17"</span><span class="p">,</span><span class="w">
  </span><span class="err">message:</span><span class="w"> </span><span class="s2">"com.apple.xpc.launchd[1] &lt;Notice&gt;: Service exited due to SIGKILL"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="err">...</span></code></pre></figure>

<h3 id="many-to-many-relationships">many-to-many relationships</h3>
<p>A possible approach to follow with many-to-many relationships is to create <em>reciprocal references</em>: the links are present twice. For example, authors and books: a single author can write multiple books; a single book can have multiple authors.</p>

<p><code class="language-plaintext highlighter-rouge">books</code> collection:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"go"</span><span class="p">,</span><span class="w"> </span><span class="err">ISBN</span><span class="mi">13</span><span class="err">:</span><span class="w"> </span><span class="s2">"9780060853983"</span><span class="p">,</span><span class="w">
  </span><span class="err">title:</span><span class="w"> </span><span class="s2">"Good Omens: The Nice and Accurate Prophecies of Agnes Nutter, Witch"</span><span class="p">,</span><span class="w">
  </span><span class="err">authors:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tprat"</span><span class="p">,</span><span class="s2">"ngaim"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"gp"</span><span class="p">,</span><span class="w"> </span><span class="err">ISBN</span><span class="mi">13</span><span class="err">:</span><span class="w"> </span><span class="s2">"9780060502935"</span><span class="p">,</span><span class="w">
  </span><span class="err">title:</span><span class="w"> </span><span class="s2">"Going Postal (Discworld #33)"</span><span class="p">,</span><span class="w">
  </span><span class="err">authors:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tprat"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"sg"</span><span class="p">,</span><span class="w"> </span><span class="err">ISBN</span><span class="mi">13</span><span class="err">:</span><span class="w"> </span><span class="s2">"9780552152976"</span><span class="p">,</span><span class="w">
  </span><span class="err">title:</span><span class="w"> </span><span class="s2">"Small Gods (Discworld #13)"</span><span class="p">,</span><span class="w">
  </span><span class="err">authors:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tprat"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"tsa"</span><span class="p">,</span><span class="w"> </span><span class="err">ISBN</span><span class="mi">13</span><span class="err">:</span><span class="w"> </span><span class="s2">"9780060842352"</span><span class="p">,</span><span class="w">
  </span><span class="err">title:</span><span class="w"> </span><span class="s2">"The Stupidest Angel: A Heartwarming Tale of Christmas Terror"</span><span class="p">,</span><span class="w">
  </span><span class="err">authors:</span><span class="w"> </span><span class="p">[</span><span class="s2">"cmoor"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span></code></pre></figure>

<p><code class="language-plaintext highlighter-rouge">authors</code> collection:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"tprat"</span><span class="p">,</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Terry Pratchett"</span><span class="p">,</span><span class="w"> </span><span class="err">books:</span><span class="w"> </span><span class="p">[</span><span class="s2">"go"</span><span class="p">,</span><span class="s2">"gp"</span><span class="p">,</span><span class="s2">"sg"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"ngaim"</span><span class="p">,</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Neil Gaiman"</span><span class="p">,</span><span class="w"> </span><span class="err">books:</span><span class="w"> </span><span class="p">[</span><span class="s2">"go"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"cmoor"</span><span class="p">,</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Christopher Moore"</span><span class="p">,</span><span class="w"> </span><span class="err">books:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tsa"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span></code></pre></figure>

<p><strong>Big word of caution</strong>: This approach can quickly lead to inconsistencies if not handled well. What if an author has written a certain book, but that book does not mention that author?</p>

<p>Another option is to use a collection specific for the links, similar to a linking table in an RDBMS:</p>

<p><code class="language-plaintext highlighter-rouge">books</code> collection:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"go"</span><span class="p">,</span><span class="w"> </span><span class="err">ISBN</span><span class="mi">13</span><span class="err">:</span><span class="w"> </span><span class="s2">"9780060853983"</span><span class="p">,</span><span class="w">
  </span><span class="err">title:</span><span class="w"> </span><span class="s2">"Good Omens: The Nice and Accurate Prophecies of Agnes Nutter, Witch"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"gp"</span><span class="p">,</span><span class="w"> </span><span class="err">ISBN</span><span class="mi">13</span><span class="err">:</span><span class="w"> </span><span class="s2">"9780060502935"</span><span class="p">,</span><span class="w">
  </span><span class="err">title:</span><span class="w"> </span><span class="s2">"Going Postal (Discworld #33)"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"sg"</span><span class="p">,</span><span class="w"> </span><span class="err">ISBN</span><span class="mi">13</span><span class="err">:</span><span class="w"> </span><span class="s2">"9780552152976"</span><span class="p">,</span><span class="w">
  </span><span class="err">title:</span><span class="w"> </span><span class="s2">"Small Gods (Discworld #13)"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"tsa"</span><span class="p">,</span><span class="w"> </span><span class="err">ISBN</span><span class="mi">13</span><span class="err">:</span><span class="w"> </span><span class="s2">"9780060842352"</span><span class="p">,</span><span class="w">
  </span><span class="err">title:</span><span class="w"> </span><span class="s2">"The Stupidest Angel: A Heartwarming Tale of Christmas Terror"</span><span class="w"> </span><span class="p">}</span></code></pre></figure>

<p><code class="language-plaintext highlighter-rouge">authors</code> collection:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"tprat"</span><span class="p">,</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Terry Pratchett"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"ngaim"</span><span class="p">,</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Neil Gaiman"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">id:</span><span class="w"> </span><span class="s2">"cmoor"</span><span class="p">,</span><span class="w"> </span><span class="err">name:</span><span class="w"> </span><span class="s2">"Christopher Moore"</span><span class="w"> </span><span class="p">}</span></code></pre></figure>

<p><code class="language-plaintext highlighter-rouge">authorships</code> collection:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w"> </span><span class="err">author:</span><span class="w"> </span><span class="s2">"tprat"</span><span class="p">,</span><span class="w"> </span><span class="err">book:</span><span class="w"> </span><span class="s2">"go"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">author:</span><span class="w"> </span><span class="s2">"tprat"</span><span class="p">,</span><span class="w"> </span><span class="err">book:</span><span class="w"> </span><span class="s2">"gp"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">author:</span><span class="w"> </span><span class="s2">"tprat"</span><span class="p">,</span><span class="w"> </span><span class="err">book:</span><span class="w"> </span><span class="s2">"sg"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">author:</span><span class="w"> </span><span class="s2">"ngaim"</span><span class="p">,</span><span class="w"> </span><span class="err">book:</span><span class="w"> </span><span class="s2">"go"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="err">author:</span><span class="w"> </span><span class="s2">"cmoor"</span><span class="p">,</span><span class="w"> </span><span class="err">book:</span><span class="w"> </span><span class="s2">"tsa"</span><span class="w"> </span><span class="p">}</span><span class="err">,</span></code></pre></figure>

<h3 id="other-considerations">Other considerations</h3>
<h4 id="use-embedding-for">Use embedding for…</h4>
<ul>
  <li><em>things that are queried together should be stored together</em>. In the blog example, it will be uncommon that you’d want to have a list of comments without them being linked to the blog entry itself. In this case, the comments can be embedded in the blog entry.</li>
  <li><em>things with similar volatility</em> (i.e. their rate of change is similar). For example, an <code class="language-plaintext highlighter-rouge">author</code> can have several social IDs on Facebook, Linkedin, Twitter, etc. These things will not change a lot so it makes sense to store them <em>inside</em> the <code class="language-plaintext highlighter-rouge">author</code> document, rather than having a separate collection <code class="language-plaintext highlighter-rouge">social_networks</code> and link the information between documents.</li>
  <li><em>set of values or subdocuments that are bounded</em> (1-to-few relationship). For example, the number of tags for a blog entry will not be immense, and be static so we can embed that.</li>
</ul>

<p>Data embedding has several advantages:</p>
<ul>
  <li>The embedded objects are returned in the same query as the parent object, meaning that only 1 trip to the database is necessary. In the example above, if you’d query for a blog entry, you get the comments and tags with it for free.</li>
  <li>Objects in the same collection are generally stored sequentially on disk, leading to fast retrieval.</li>
  <li>If the document model matches your domain, it is much easier to understand than a normalised relational database.</li>
</ul>

<h4 id="use-referencing-for">Use referencing for…</h4>
<ul>
  <li><em>1-to-many relationships</em>. For example, a single author can write multiple blog posts. We don’t want to copy the author’s name, email, social network usernames, picture, etc into every single blog entry.</li>
  <li><em>many-to-many relationships</em>. What is a single author has written multiple blog posts, and blog posts can be co-written by many authors?</li>
  <li><em>related data that changes with different volatility</em>. Let’s say that we also record “likes” and “shares” for blog posts. That information is much less important and changes much quicker than the blog entry itself. Instead of constantly updating the blog document, it’s safer to keep this outside.</li>
</ul>

<p>Typically you would <em>combine embedding and referencing</em>.</p>

<h2 id="conclusion">Conclusion</h2>
<p>Data modelling in document-oriented databases is <em>not</em> straightforward and there is no single solution. It all depends on what you want to do. This is different from data modelling in RDBMS where you can work towards a normalised database schema.</p>

<div class="seriesContext">
  
  
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      
      
  
  

  
    <a href="nosql-document-databases-data-modelling-patterns.html"><button type="button" class="btn btn-primary">Next: Data modelling patterns</button></a>
  
</div>



    <div class="tags">
        
    </div>




</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2021 Visual Data Analysis Lab. All rights reserved. <br />
 Site last generated: Nov 22, 2021 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>

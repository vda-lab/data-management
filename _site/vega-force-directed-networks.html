<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" vega">
<title>Force-directed-networks | Data Management</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-custom.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="data-management" href="http://localhost:4000/feed.xml">

<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Data Management</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/vda-lab/data-management" target="_blank" rel="noopener">GitHub</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="rdbms_landing_page.html">Relational databases and SQL</a></li>
                        
                        
                        
                        <li><a href="vegalite_landing_page.html">Vega-lite</a></li>
                        
                        
                        
                        <li><a href="vega_landing_page.html">Vega</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Force-directed-networks">{title}</a></li>',
                    noResultsText: '',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Vega tutorial </li>
  
  
  
      
  
  <li>
      <a title="Creating static images" href="#">Creating static images</a>
      <ul>
          
          
          
          <li><a title="A simple scatterplot" href="vega-simple-scatterplot.html">A simple scatterplot</a></li>
          
          
          
          
          
          
          <li><a title="Changing colour" href="vega-changing-colour.html">Changing colour</a></li>
          
          
          
          
          
          
          <li><a title="Data-independent-marks" href="vega-data-independent-marks.html">Data-independent-marks</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Scales" href="#">Scales</a>
      <ul>
          
          
          
          <li><a title="Overview" href="vega-scales-overview.html">Overview</a></li>
          
          
          
          
          
          
          <li><a title="Colour scales" href="vega-colour-scales.html">Colour scales</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Enter - Update - Exit" href="#">Enter - Update - Exit</a>
      <ul>
          
          
          
          <li><a title="Enter - Update - Exit" href="vega-enter-update-exit.html">Enter - Update - Exit</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Axes" href="#">Axes</a>
      <ul>
          
          
          
          <li><a title="Axes" href="vega-axes.html">Axes</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Legends" href="#">Legends</a>
      <ul>
          
          
          
          <li><a title="Legends" href="vega-legends.html">Legends</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Loading external data" href="#">Loading external data</a>
      <ul>
          
          
          
          <li><a title="Loading external data" href="vega-loading-external-data.html">Loading external data</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Transforms" href="#">Transforms</a>
      <ul>
          
          
          
          <li><a title="Transforms" href="vega-transforms.html">Transforms</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Interaction" href="#">Interaction</a>
      <ul>
          
          
          
          <li><a title="Simple interaction" href="vega-simple-interaction.html">Simple interaction</a></li>
          
          
          
          
          
          
          <li><a title="Advanced interaction" href="vega-advanced-interaction.html">Advanced interaction</a></li>
          
          
          
          
          
          
          <li><a title="Event streams" href="vega-event-streams.html">Event streams</a></li>
          
          
          
          
          
          
          <li><a title="Combining event streams" href="vega-combining-event-streams.html">Combining event streams</a></li>
          
          
          
          
          
          
          <li><a title="Signals" href="vega-signals.html">Signals</a></li>
          
          
          
          
          
          
          <li><a title="Using widgets to send signals" href="vega-using-widgets-to-send-signals.html">Using widgets to send signals</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Composing plots" href="#">Composing plots</a>
      <ul>
          
          
          
          <li><a title="Composing plots" href="vega-composing-plots.html">Composing plots</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Advanced transforms" href="#">Advanced transforms</a>
      <ul>
          
          
          
          <li><a title="Advanced transforms" href="vega-advanced-transforms.html">Advanced transforms</a></li>
          
          
          
          
          
          
          <li><a title="Force-directed networks" href="vega-force-directed-networks.html">Force-directed networks</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Brushing and linking" href="#">Brushing and linking</a>
      <ul>
          
          
          
          <li><a title="Brushing and linking" href="vega-brushing-and-linking.html">Brushing and linking</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Debugging" href="#">Debugging</a>
      <ul>
          
          
          
          <li><a title="Debugging" href="vega-debugging.html">Debugging</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Further exercises" href="#">Further exercises</a>
      <ul>
          
          
          
          <li><a title="Further exercises" href="vega-further-exercises.html">Further exercises</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block: -->
         <!-- <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p> -->

</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Force-directed-networks</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

   <p>Let’s start with a node-link diagram for a network. We’ll use the miserables dataset for this.</p>

<h3 id="minimal-network">Minimal network</h3>
<p>Here’s a minimal vega specification, without colours or dragging:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="s2">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://vega.github.io/schema/vega/v5.json"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">350</span><span class="p">,</span><span class="w">
  </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="p">,</span><span class="w">
  </span><span class="s2">"padding"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"autosize"</span><span class="p">:</span><span class="w"> </span><span class="s2">"none"</span><span class="p">,</span><span class="w">

  </span><span class="s2">"signals"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cx"</span><span class="p">,</span><span class="w"> </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"width / 2"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cy"</span><span class="p">,</span><span class="w"> </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"height / 2"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">

  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node-data"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/vega/vega-datasets/master/data/miserables.json"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"format"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json"</span><span class="p">,</span><span class="w"> </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nodes"</span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link-data"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/vega/vega-datasets/master/data/miserables.json"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"format"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json"</span><span class="p">,</span><span class="w"> </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"links"</span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">

  </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nodes"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"symbol"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"zindex"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">

      </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node-data"</span><span class="p">},</span><span class="w">

      </span><span class="s2">"encode"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"enter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"fill"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">

      </span><span class="s2">"transform"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"force"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"iterations"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"velocityDecay"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.4</span><span class="p">,</span><span class="w">
          </span><span class="s2">"forces"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="s2">"force"</span><span class="p">:</span><span class="w"> </span><span class="s2">"center"</span><span class="p">,</span><span class="w"> </span><span class="s2">"x"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"signal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cx"</span><span class="p">},</span><span class="w"> </span><span class="s2">"y"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"signal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cy"</span><span class="p">}},</span><span class="w">
            </span><span class="p">{</span><span class="s2">"force"</span><span class="p">:</span><span class="w"> </span><span class="s2">"collide"</span><span class="p">,</span><span class="w"> </span><span class="s2">"radius"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="s2">"force"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nbody"</span><span class="p">,</span><span class="w"> </span><span class="s2">"strength"</span><span class="p">:</span><span class="w"> </span><span class="mi">-10</span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="s2">"force"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w"> </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link-data"</span><span class="p">,</span><span class="w"> </span><span class="s2">"distance"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"path"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link-data"</span><span class="p">},</span><span class="w">
      </span><span class="s2">"interactive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"encode"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"stroke"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"lightgrey"</span><span class="p">},</span><span class="w">
          </span><span class="s2">"strokeWidth"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"transform"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"linkpath"</span><span class="p">,</span><span class="w"> </span><span class="s2">"shape"</span><span class="p">:</span><span class="w"> </span><span class="s2">"line"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"sourceX"</span><span class="p">:</span><span class="w"> </span><span class="s2">"datum.source.x"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sourceY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"datum.source.y"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"targetX"</span><span class="p">:</span><span class="w"> </span><span class="s2">"datum.target.x"</span><span class="p">,</span><span class="w"> </span><span class="s2">"targetY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"datum.target.y"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>This is what the plot looks like:</p>

<p><img src="/assets/vega-force-1.png" width="50%" /></p>

<p>Let’s break this down:</p>

<ul>
  <li><code class="highlighter-rouge">data</code>: If you follow the URL to the JSON file, you’ll see that it looks like this: <code class="highlighter-rouge">{nodes: [], links: []}</code>. We create two different datasets: one for the nodes and one for the links. The <code class="highlighter-rouge">format.property</code> bit specifies which part needs to be extracted. It would seem that we’d be able to do this using a single dataset and creating two derived ones using <code class="highlighter-rouge">source</code>, but unfortunately it’s not possible to extract a single element using a transform.</li>
  <li><code class="highlighter-rouge">marks</code>: There are two types of marks, namely for the nodes and for the edges. In principle, you can draw the nodes without the edges (try it), but not the other way around because the edge positions depend on the source and target nodes.
    <ul>
      <li>For the <em>nodes</em>, everything is the same as we saw in all our previous exercises, except for the <code class="highlighter-rouge">zindex</code> and <code class="highlighter-rouge">transform</code>. The <code class="highlighter-rouge">"zindex": 1</code> makes sure that the nodes are drawn <em>on top of</em> the edges.
        <ul>
          <li><code class="highlighter-rouge">transform</code>: Definitely have a good look at the <a href="https://vega.github.io/vega/docs/transforms/force/">documentation</a> for this. We use a single transform of type <code class="highlighter-rouge">force</code>. Actually, it’s not just one force, but several which we list under <code class="highlighter-rouge">"forces": []</code>. The algorithm will try to find an equilibrium between all of these interacting forces.
            <ul>
              <li><code class="highlighter-rouge">center</code>: Indicates what the center of the plot should be. This would typically be the center of your screen, i.e. <code class="highlighter-rouge">width/2</code> and <code class="highlighter-rouge">height/2</code>.</li>
              <li><code class="highlighter-rouge">collide</code>: To what extent should nodes be pushed apart, but only when they overlap.</li>
              <li><code class="highlighter-rouge">nbody</code>: To what extent should nodes be pushed apart or attracted. A negative value will push them apart; a positive one will pull them together. This value will have the largest impact on what your plot looks like.</li>
              <li><code class="highlighter-rouge">link</code>: While <code class="highlighter-rouge">nbody</code> will push nodes apart or attract them, this is contrained by the links between them.</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>For the <em>links</em>, we use <code class="highlighter-rouge">path</code> marks instead of <code class="highlighter-rouge">line</code> because the first can have arbitrary position, while lines are used for longitudinal data.
        <ul>
          <li>We set <code class="highlighter-rouge">stroke</code> and <code class="highlighter-rouge">strokeWidth</code> in an <code class="highlighter-rouge">update</code> section instead of <code class="highlighter-rouge">enter</code>. If we’d use enter, the paths wouldn’t update when the nodes move around. You’d get a picture like this instead:<br /><img src="/assets/vega-force-link-enter.png" width="50%" /></li>
          <li><code class="highlighter-rouge">transform</code>: We use the special <code class="highlighter-rouge">linkpath</code> transform, which is specifically for drawing a path between a source and a target. Apart from <code class="highlighter-rouge">line</code>, the <code class="highlighter-rouge">shape</code> can also be a <code class="highlighter-rouge">curve</code>, <code class="highlighter-rouge">arc</code>, <code class="highlighter-rouge">diagonal</code> or <code class="highlighter-rouge">orthogonal</code>. Try these out as well.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>Here are some examples of plots with different settings for <code class="highlighter-rouge">collide</code>, <code class="highlighter-rouge">nbody</code> and <code class="highlighter-rouge">link</code> in the node transform:</p>

<p>Altering <code class="highlighter-rouge">collide</code>, with <code class="highlighter-rouge">nbody</code> equal to <code class="highlighter-rouge">-10</code> and <code class="highlighter-rouge">link</code> equal to <code class="highlighter-rouge">15</code>:</p>

<table>
  <thead>
    <tr>
      <th><code class="highlighter-rouge">1</code></th>
      <th><code class="highlighter-rouge">5</code></th>
      <th><code class="highlighter-rouge">10</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><img src="/assets/vega-force-1-10-15.png" width="100%" /></td>
      <td><img src="/assets/vega-force-5-10-15.png" width="100%" /></td>
      <td><img src="/assets/vega-force-10-10-15.png" width="100%" /></td>
    </tr>
  </tbody>
</table>

<p>Altering <code class="highlighter-rouge">nbody</code>, with <code class="highlighter-rouge">collide</code> equal to <code class="highlighter-rouge">5</code> and <code class="highlighter-rouge">link</code> equal to <code class="highlighter-rouge">15</code>:</p>

<table>
  <thead>
    <tr>
      <th><code class="highlighter-rouge">-2</code></th>
      <th><code class="highlighter-rouge">-10</code></th>
      <th><code class="highlighter-rouge">-20</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><img src="/assets/vega-force-5-2-15.png" width="100%" /></td>
      <td><img src="/assets/vega-force-5-10-15.png" width="100%" /></td>
      <td><img src="/assets/vega-force-5-20-15.png" width="100%" /></td>
    </tr>
  </tbody>
</table>

<p>Altering <code class="highlighter-rouge">link</code>, with <code class="highlighter-rouge">collide</code> equal to <code class="highlighter-rouge">5</code> and <code class="highlighter-rouge">nbody</code> equal to <code class="highlighter-rouge">-10</code>:</p>

<table>
  <thead>
    <tr>
      <th><code class="highlighter-rouge">5</code></th>
      <th><code class="highlighter-rouge">15</code></th>
      <th><code class="highlighter-rouge">30</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><img src="/assets/vega-force-5-10-5.png" width="100%" /></td>
      <td><img src="/assets/vega-force-5-10-15.png" width="100%" /></td>
      <td><img src="/assets/vega-force-5-10-30.png" width="100%" /></td>
    </tr>
  </tbody>
</table>

<p class="exercise"><strong>Exercise</strong> - What happens if you change the value of <code class="highlighter-rouge">nbody</code> to 1? Or to 10? Does the value of <code class="highlighter-rouge">collide</code> have an effect? If so: what effect?</p>

<h3 id="adding-node-dragging">Adding node dragging</h3>
<p>Here’s an example where we can drag nodes around. It looks complex, but all should become clear when we break this example down.</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="s2">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://vega.github.io/schema/vega/v5.json"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
  </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">275</span><span class="p">,</span><span class="w">
  </span><span class="s2">"padding"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"autosize"</span><span class="p">:</span><span class="w"> </span><span class="s2">"none"</span><span class="p">,</span><span class="w">

  </span><span class="s2">"signals"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cx"</span><span class="p">,</span><span class="w"> </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"width / 2"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cy"</span><span class="p">,</span><span class="w"> </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"height / 2"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"State variable for active node dragged status."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dragged"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"on"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"events"</span><span class="p">:</span><span class="w"> </span><span class="s2">"symbol:mouseout[!event.buttons], window:mouseup"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"events"</span><span class="p">:</span><span class="w"> </span><span class="s2">"symbol:mouseover"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dragged || 1"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"events"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[symbol:mousedown, window:mouseup] &gt; window:mousemove!"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"force"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Graph node most recently interacted with."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dragged_node"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"on"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"events"</span><span class="p">:</span><span class="w"> </span><span class="s2">"symbol:mouseover"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dragged === 1 ? item() : dragged_node"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Flag to restart Force simulation upon data changes."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"restart"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"on"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="s2">"events"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"signal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dragged"</span><span class="p">},</span><span class="w"> </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dragged &gt; 1"</span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">

  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node-data"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/vega/vega-datasets/master/data/miserables.json"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"format"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json"</span><span class="p">,</span><span class="w"> </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nodes"</span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link-data"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/vega/vega-datasets/master/data/miserables.json"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"format"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json"</span><span class="p">,</span><span class="w"> </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"links"</span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">

  </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nodes"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"symbol"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"zindex"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">

      </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node-data"</span><span class="p">},</span><span class="w">
      </span><span class="s2">"on"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dragged"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"modify"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dragged_node"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"values"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dragged === 1 ? {fx:dragged_node.x, fy:dragged_node.y} : {fx:x(), fy:y()}"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"!dragged"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"modify"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dragged_node"</span><span class="p">,</span><span class="w"> </span><span class="s2">"values"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{fx: null, fy: null}"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">

      </span><span class="s2">"encode"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"enter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"fill"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">},</span><span class="w">
          </span><span class="s2">"cursor"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pointer"</span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">

      </span><span class="s2">"transform"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"force"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"iterations"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"velocityDecay"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.4</span><span class="p">,</span><span class="w">
          </span><span class="s2">"restart"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"signal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"restart"</span><span class="p">},</span><span class="w">
          </span><span class="s2">"static"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
          </span><span class="s2">"forces"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="s2">"force"</span><span class="p">:</span><span class="w"> </span><span class="s2">"center"</span><span class="p">,</span><span class="w"> </span><span class="s2">"x"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"signal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cx"</span><span class="p">},</span><span class="w"> </span><span class="s2">"y"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"signal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cy"</span><span class="p">}},</span><span class="w">
            </span><span class="p">{</span><span class="s2">"force"</span><span class="p">:</span><span class="w"> </span><span class="s2">"collide"</span><span class="p">,</span><span class="w"> </span><span class="s2">"radius"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="s2">"force"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nbody"</span><span class="p">,</span><span class="w"> </span><span class="s2">"strength"</span><span class="p">:</span><span class="w"> </span><span class="mi">-10</span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="s2">"force"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w"> </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link-data"</span><span class="p">,</span><span class="w"> </span><span class="s2">"distance"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"path"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link-data"</span><span class="p">},</span><span class="w">
      </span><span class="s2">"interactive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"encode"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"update"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"stroke"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"lightgrey"</span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"transform"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"linkpath"</span><span class="p">,</span><span class="w"> </span><span class="s2">"shape"</span><span class="p">:</span><span class="w"> </span><span class="s2">"line"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"sourceX"</span><span class="p">:</span><span class="w"> </span><span class="s2">"datum.source.x"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sourceY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"datum.source.y"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"targetX"</span><span class="p">:</span><span class="w"> </span><span class="s2">"datum.target.x"</span><span class="p">,</span><span class="w"> </span><span class="s2">"targetY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"datum.target.y"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>Here is the result (drag one of the nodes):</p>

<div id="vis6"></div>
<script type="text/javascript">
  var yourVlSpec = {
    "$schema": "https://vega.github.io/schema/vega/v5.json",
    "width": 400,
    "height": 275,
    "padding": 0,
    "autosize": "none",

    "signals": [
      { "name": "cx", "update": "width / 2" },
      { "name": "cy", "update": "height / 2" },
      {
        "description": "State variable for active node dragged status.",
        "name": "dragged", "value": 0,
        "on": [
          {
            "events": "symbol:mouseout[!event.buttons], window:mouseup",
            "update": "0"
          },
          {
            "events": "symbol:mouseover",
            "update": "dragged || 1"
          },
          {
            "events": "[symbol:mousedown, window:mouseup] > window:mousemove!",
            "update": "2", "force": true
          }
        ]
      },
      {
        "description": "Graph node most recently interacted with.",
        "name": "dragged_node", "value": null,
        "on": [
          {
            "events": "symbol:mouseover",
            "update": "dragged === 1 ? item() : dragged_node"
          }
        ]
      },
      {
        "description": "Flag to restart Force simulation upon data changes.",
        "name": "restart", "value": false,
        "on": [
          {"events": {"signal": "dragged"}, "update": "dragged > 1"}
        ]
      }
    ],

    "data": [
      {
        "name": "node-data",
        "url": "https://raw.githubusercontent.com/vega/vega-datasets/master/data/miserables.json",
        "format": {"type": "json", "property": "nodes"}
      },
      {
        "name": "link-data",
        "url": "https://raw.githubusercontent.com/vega/vega-datasets/master/data/miserables.json",
        "format": {"type": "json", "property": "links"}
      }
    ],

    "marks": [
      {
        "name": "nodes",
        "type": "symbol",
        "zindex": 1,

        "from": {"data": "node-data"},
        "on": [
          {
            "trigger": "dragged",
            "modify": "dragged_node",
            "values": "dragged === 1 ? {fx:dragged_node.x, fy:dragged_node.y} : {fx:x(), fy:y()}"
          },
          {
            "trigger": "!dragged",
            "modify": "dragged_node", "values": "{fx: null, fy: null}"
          }
        ],

        "encode": {
          "enter": {
            "fill": {"value": "grey"}
          },
          "update": {
            "size": {"value": 50},
            "cursor": {"value": "pointer"}
          }
        },

        "transform": [
          {
            "type": "force",
            "iterations": 300,
            "velocityDecay": 0.4,
            "restart": {"signal": "restart"},
            "static": false,
            "forces": [
              {"force": "center", "x": {"signal": "cx"}, "y": {"signal": "cy"}},
              {"force": "collide", "radius": 5},
              {"force": "nbody", "strength": -10},
              {"force": "link", "links": "link-data", "distance": 15}
            ]
          }
        ]
      },
      {
        "type": "path",
        "from": {"data": "link-data"},
        "interactive": false,
        "encode": {
          "update": {
            "stroke": {"value": "lightgrey"}
          }
        },
        "transform": [
          {
            "type": "linkpath", "shape": "line",
            "sourceX": "datum.source.x", "sourceY": "datum.source.y",
            "targetX": "datum.target.x", "targetY": "datum.target.y"
          }
        ]
      }
    ]
  };
  vegaEmbed('#vis6', yourVlSpec);
</script>

<p>What has changed?</p>

<ul>
  <li>A signal <code class="highlighter-rouge">dragged</code> captures if anything is dragged. Possible values are: <code class="highlighter-rouge">0</code> (nothing is being dragged), <code class="highlighter-rouge">1</code> (on mouseover: something <em>could</em> be dragged) and <code class="highlighter-rouge">2</code> (something is actually being dragged).</li>
  <li>A signal <code class="highlighter-rouge">dragged_node</code>, which is a container for the actual node being dragged. If the value of <code class="highlighter-rouge">dragged</code> is <code class="highlighter-rouge">1</code> (i.e. ready to drag, but not actually dragging yet), the value for <code class="highlighter-rouge">dragged_node</code> will be set to <code class="highlighter-rouge">item()</code>, which is the element on which an event is active (see <a href="https://vega.github.io/vega/docs/expressions/#item">here</a>). Why do we actually check for the value of <code class="highlighter-rouge">dragged</code>? If you don’t and start dragging a node across another one, it might happen that your mouse picks up the other node than the original one on the way.</li>
  <li>A signal <code class="highlighter-rouge">restart</code> to ensure that positions of the nodes are recalculated when we drag a node to a new position. Now how does the code <code class="highlighter-rouge">{"events": {"signal": "dragged"}, "update": "dragged &gt; 1"}</code> actually work? The signal will fire every time the <code class="highlighter-rouge">dragged</code> signal changes. Its <code class="highlighter-rouge">update</code> is <code class="highlighter-rouge">dragged &gt; 1</code>. <code class="highlighter-rouge">dragged &gt; 1</code> is a <em>test</em>: it returns <code class="highlighter-rouge">true</code> or <code class="highlighter-rouge">false</code>. It is this <code class="highlighter-rouge">true</code> or <code class="highlighter-rouge">false</code> that will be stored in the symbol <code class="highlighter-rouge">restart</code>.</li>
  <li>A <em>trigger</em> <code class="highlighter-rouge">dragged</code> on the nodes changes the <code class="highlighter-rouge">dragged_node</code>’s <code class="highlighter-rouge">fx</code> and <code class="highlighter-rouge">fy</code>. <code class="highlighter-rouge">fx</code> and <code class="highlighter-rouge">fy</code> are two special fields on a node object, and stand for <em>fixed</em> x and <em>fixed</em> y. If <code class="highlighter-rouge">dragged === 1</code> (i.e. the mouse hovers over the node), <code class="highlighter-rouge">fx</code> is set to the <code class="highlighter-rouge">x</code>-position of <code class="highlighter-rouge">dragged_node</code> and <code class="highlighter-rouge">fy</code> accordingly. This is so that the node stays in a fixed position while you’re on top of it and does not escape from under the mouse. If <code class="highlighter-rouge">dragged</code> is not <code class="highlighter-rouge">1</code> (i.e. it’s <code class="highlighter-rouge">2</code>), <code class="highlighter-rouge">fx</code> and <code class="highlighter-rouge">fy</code> are set to <code class="highlighter-rouge">x()</code> and <code class="highlighter-rouge">y()</code> which are the x- and y-position of the mouse. So as your mouse moves around, the node will follow.</li>
  <li>A trigger <code class="highlighter-rouge">!dragged</code>, which stands for <em>not dragged</em>. When the signal <code class="highlighter-rouge">dragged</code> is set to 0, <code class="highlighter-rouge">fx</code> and <code class="highlighter-rouge">fy</code> are set to <code class="highlighter-rouge">null</code>, meaning that the node can participate again in all forces in the network.</li>
</ul>

<p class="exercise"><strong>Exercise</strong> - The individuals in the miserables data belong to different groups. Use these groups to set the colour of the nodes.</p>

<p class="exercise"><strong>Exercise</strong> - Create two plots next to each other: one with this network, and one with a histogram of the number of individuals per group. So something like this:<br /><img src="/assets/vega-force-histogram.png" width="50%" /><br />Extra points if you can give the bars the same colour as the nodes in the graph.</p>

<!--
{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "padding": 0,
  "autosize": "none",
  "width": 800,
  "height": 400,

  "signals": [
    {
      "description": "State variable for active node dragged status.",
      "name": "dragged", "value": 0,
      "on": [
        {
          "events": "symbol:mouseout[!event.buttons], window:mouseup",
          "update": "0"
        },
        {
          "events": "symbol:mouseover",
          "update": "dragged || 1"
        },
        {
          "events": "[symbol:mousedown, window:mouseup] > window:mousemove!",
          "update": "2", "force": true
        }
      ]
    },
    {
      "description": "Graph node most recently interacted with.",
      "name": "dragged_node", "value": null,
      "on": [
        {
          "events": "symbol:mouseover",
          "update": "dragged === 1 ? item() : dragged_node"
        }
      ]
    },
    {
      "description": "Flag to restart Force simulation upon data changes.",
      "name": "restart", "value": false,
      "on": [
        {"events": {"signal": "dragged"}, "update": "dragged > 1"}
      ]
    }
  ],

  "data": [
    {
      "name": "node-data",
      "url": "https://raw.githubusercontent.com/vega/vega-datasets/master/data/miserables.json",
      "format": {"type": "json", "property": "nodes"}
    },
    {
      "name": "link-data",
      "url": "https://raw.githubusercontent.com/vega/vega-datasets/master/data/miserables.json",
      "format": {"type": "json", "property": "links"}
    },
    { "name": "hist-data",
      "source": "node-data",
      "transform": [
        {"type": "aggregate", "groupby": ["group"], "as": ["count"]}
      ]
    }
  ],

  "scales": [
    {
      "name": "color",
      "type": "ordinal",
      "range": {"scheme": "category10"}
    },
    { "name": "xscale",
      "type": "linear",
      "domain": [0,10],
      "range": [100,300]
    },
    { "name": "yscale",
      "type": "linear",
      "domain": [0,15],
      "range": [100,200]
    }
  ],

  "layout": {"padding": 20},

  "marks": [
    {"name": "network",
      "type": "group",
      "marks": [
        {
          "name": "nodes",
          "type": "symbol",
          "zindex": 1,

          "from": {"data": "node-data"},
          "on": [
            {
              "trigger": "dragged",
              "modify": "dragged_node",
              "values": "dragged === 1 ? {fx:dragged_node.x, fy:dragged_node.y} : {fx:x(), fy:y()}"
            },
            {
              "trigger": "!dragged",
              "modify": "dragged_node", "values": "{fx: null, fy: null}"
            }
          ],

          "encode": {
            "enter": {
              "fill": {"scale": "color", "field": "group"},
              "tooltip": {"field": "name"}
            },
            "update": {
              "size": {"value": 50},
              "cursor": {"value": "pointer"}
            }
          },

          "transform": [
            {
              "type": "force",
              "iterations": 300,
              "velocityDecay": 0.4,
              "restart": {"signal": "restart"},
              "static": false,
              "forces": [
                {"force": "center", "x": 200, "y": 200},
                {"force": "collide", "radius": 5},
                {"force": "nbody", "strength": -10},
                {"force": "link", "links": "link-data", "distance": 15}
              ]
            }
          ]
        },
        {
          "type": "path",
          "from": {"data": "link-data"},
          "interactive": false,
          "encode": {
            "update": {
              "stroke": {"value": "lightgrey"}
            }
          },
          "transform": [
            {
              "type": "linkpath", "shape": "line",
              "sourceX": "datum.source.x", "sourceY": "datum.source.y",
              "targetX": "datum.target.x", "targetY": "datum.target.y"
            }
          ]
        }
      ]
    },
    {"name": "histogram",
      "type": "group",
      "marks": [
        {
          "type": "rect",
          "from": {"data":"hist-data"},
          "encode": {
            "enter": {
              "x": {"scale": "xscale", "field": "group"},
              "y2": {"value": 300},
              "width": {"value": 15},
              "height": {"scale": "yscale", "field": "count"},
              "fill": {"value": "steelblue"}
            }
          }
        }
      ]
    }
  ]
}
-->

<div class="seriesContext">
    <a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <a href="vega-brushing-and-linking.html"><button type="button" class="btn btn-primary">Next: Brushing and linking</button></a>
        
    </a>
</div>



    <div class="tags">
        
    </div>




</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2020 Visual Data Analysis Lab. All rights reserved. <br />
 Site last generated: Jan 19, 2020 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>

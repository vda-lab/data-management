<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.15">
<meta name="author" content="Jan Aerts">
<title>Data Management</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css">
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="_relational_database_management_systems" class="article toc2 toc-left">
<div id="header">
<h1>Data Management</h1>
<div class="details">
<span id="author" class="author">Jan Aerts</span><br>
<span id="email" class="email"><a href="mailto:jan.aerts@uhasselt.be">jan.aerts@uhasselt.be</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="index.html">Data Management</a></span></p><ul class="sectlevel1">
<li><a href="_relational_database_management_systems.html"><span class="toc-current">1. Relational Database Management Systems</span></a>
<ul class="sectlevel2">
<li><a href="_relational_database_management_systems.html#_examples_of_data">1.1. Examples of data</a>
</li>
<li><a href="_relational_database_management_systems.html#_relational_databases">1.2. Relational databases</a>
</li>
<li><a href="_relational_database_management_systems.html#_database_schema_and_normalisation">1.3. Database schema and normalisation</a>
</li>
<li><a href="_relational_database_management_systems.html#_sql_structured_query_language">1.4. SQL - Structured Query Language</a>
</li>
<li><a href="_relational_database_management_systems.html#_drawbacks_of_relational_databases">1.5. Drawbacks of relational databases</a>
</li>
</ul>
</li>
<li><a href="_nosql_an_introduction.html">2. NoSQL: an introduction</a>
</li>
<li><a href="_keyvalue_stores.html">3. Key/value stores</a>
</li>
<li><a href="_document_oriented_databases.html">4. Document-oriented databases</a>
</li>
<li><a href="_graph_databases.html">5. Graph databases</a>
</li>
<li><a href="_arangodb.html">6. ArangoDB</a>
</li>
<li><a href="_arangodb_apis.html">7. ArangoDB APIs</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_relational_database_management_systems">1. Relational Database Management Systems</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a <em>practical</em> introduction to relational database management systems and SQL. The text is written focussing on how you can get things done, and does not go into the theoretical and technical backgrounds. The online version of this text is available at <a href="http://vda-lab.github.io/data-management" class="bare">http://vda-lab.github.io/data-management</a></p>
</div>
<div class="paragraph">
<p>Working with data almost invariably involves working with relational databases and SQL (Structured Query Language). They have a decades-old history and are very established. In this section, we go over the why and how of this type of database.</p>
</div>
<div class="paragraph">
<p>Let’s look at some example life science fields where we collect data to make the rest of the session a bit more concrete.</p>
</div>
<div class="sect2">
<h3 id="_examples_of_data">1.1. Examples of data</h3>
<div class="sect3">
<h4 id="_clinical_trials">1.1.1. Clinical trials</h4>
<div class="paragraph">
<p>A clinical trial is a study involving the assessment of one or more regimens used in treating or preventing a specific illness or disease (McFadden, 2007). The design, aim, number of patients etc. depend on the phase of the clinical trial. Different types of data are collected:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Administrative data</em> describes information to uniquely identify a patient and their contact details. Often, the name cannot be used due to the fact that multiple people can have the same name, but more importantly to ensure minimal identifiability (privacy); therefore a unique patient ID is generated at enrolment. In addition, information like the name of the trial and name of the center in large multicenter trials are recorded.</p>
</li>
<li>
<p><em>Research data</em> is all information needed to answer study objective(s) in the protocol, including measurements of endpoints, relevant dates (study entry, treatment administration), etc. The amount of research data to be collected varies widely. It is important to collect only relevant data, as not all clinically relevant data is relevant research data. For example, exact timing of intervention may be relevant for clinical care (record in medical file), but not to answer research questions. Collection of irrelevant data increases time and effort to collect, enter, and process this data, increases the complexity of the database and risk for missing data, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The trial protocol describes which data items need to be collected, based on which a Case Report Form (CRF) is developed. The CRF is the official clinical data-recording document used in a clinical study which stores all relevant patient info that is obtained in a clinical trial. It should be of high quality as a poor design can lead to unreliable data and possibly wrong conclusions of the study.</p>
</div>
<div class="paragraph">
<p>Items on a CRF are organised according to the following rationale:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They should follow the time flow of the trial (when are the data collected?). For example, items collected at study entry (e.g., medical history,
treatment allocation, etc.) are grouped together and as well as for all follow-up phases (e.g., primary endpoint measures, adverse effects at particular time point).</p>
</li>
<li>
<p>The should reflect the logistics and practical organisation of the trial (where and by whom are the data collected?). For example: some data at study entry may be collected by the CRA, other data by the physician; some data at study entry may be gathered in the cardiology department, other data in the radiology department.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Separate sections/pages on the CRF are created for each logical division.</p>
</div>
<div class="paragraph">
<p>Below are two annotated pages from a CRF. The red annotations are meant for the data management department and indicate which variable in the database each piece of information is stored in.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/CRF_1.png" alt="CRF 1"></span>
<span class="image"><img src="assets/CRF_2.png" alt="CRF 2"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_epidemiological_studies">1.1.2. Epidemiological studies</h4>
<div class="paragraph">
<p>Epidemiology is described as "the study of the occurrence and distribution of health-related states or events in specified populations, including the study of determinants influencing such states, and the application of this knowledge to control the health problems" (Dictionary of Epidemiology, Porta 2008). It covers a very broad and diverse line of research:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>experimental vs observational studies</p>
</li>
<li>
<p>within the observational studies:</p>
<div class="ulist">
<ul>
<li>
<p>exploratory vs descriptive</p>
</li>
<li>
<p>exposure vs outcome oriented</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The collected data can also be very diverse, and include questionnaires, forms, medical device outcomes, biological data, etc.</p>
</div>
<div class="paragraph">
<p>Epidemiological studies are generally done in one of two settings: primary (based on newly collected data) or secondary (using existing databases).</p>
</div>
<div class="paragraph">
<p>Generally a codebook or data dictionary that describes all data sources (collected, derived, transformed, &#8230;&#8203;). An example of a data dictionary is provided below (taken from Ahrens, W. et al. (2014): Handbook of epidemiology. Table 27.2).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/datadictionary.png" alt="datadictionary"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_dna_sequencing_and_genotyping">1.1.3. DNA sequencing and genotyping</h4>
<div class="paragraph">
<p>The importance of DNA sequencing and genotyping is steadily increasing within research and health care. In genotyping, one reads the nucleotides at specific positions in the genome to check if the patient has an allele that for example constitutes a higher risk to certain diseases, or that indicates higher or lower sensitivity to certain medication.</p>
</div>
<div class="paragraph">
<p>For example, mutations in the BRCA1 and BRCA2 genes change a person&#8217;s chance of getting breast cancer (see <a href="http://arup.utah.edu/database/BRCA/Variants/BRCA2.php" class="bare">http://arup.utah.edu/database/BRCA/Variants/BRCA2.php</a> for a list of possible mutations in BRCA2 and their pathogenicity). One of the many harmful mutations is a mutation at position 32,316,517 on chromosome 13 (in exon 2 of BRCA2) that changes a C to an A, resulting in a stop codon.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/brca2.png" alt="brca2"></span></p>
</div>
<div class="paragraph">
<p>Genotyping results therefore contain information on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the individual</p>
</li>
<li>
<p>the polymorphism (i.e. identifying what nucleotide is changed) position in the genome (i.e. chr13 position 32,316,517)</p>
</li>
<li>
<p>the allele (i.e. C or A)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For each, additional information can be recorded:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for the individual: their name, ethnicity</p>
</li>
<li>
<p>for the polymorphism: the unique identifier in a central database (in this case: rs878853592), the chromosome (chr13), the position (32,316,517), the allele that occurs in healthy individuals (i.e. C)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example genotype table:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/genotype_table.png" alt="genotype table"></span></p>
</div>
<div class="paragraph">
<p>This table contains the information for 3 polymorphisms (called rs12345, rs98765 and rs28465) for 2 individuals (individual_A and individual_B). Typically, thousands of polymorphisms are recorded for thousands of individuals.
A particular type of polymorphism is the single nucleotide polymorphism (SNP), which will be why tables below will be called <code>snps</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_relational_databases">1.2. Relational databases</h3>
<div class="paragraph">
<p>There is a wide variety of database systems to store data, but the most-used in the relational database management system (RDBMS). These basically consist of tables that contain rows (which represent instance data) and columns (representing properties of that data). Any table can be thought of as an Excel-sheet.</p>
</div>
<div class="paragraph">
<p>Relational databases are the most wide-spread paradigm used to store data. They use the concept of tables with each <strong>row</strong> containing an <strong>instance of the data</strong>, and each <strong>column</strong> representing different <strong>properties</strong> of that instance of data. Different implementations exist, include ones by Oracle and MySQL. For many of these (including Oracle and MySQL), you need to run a database server in the background. People (or you) can then connect to that server via a client. In this session, however, we&#8217;ll use <strong>SQLite3</strong>. SQLite is used by Firefox, Chrome, Android, Skype, &#8230;&#8203;</p>
</div>
<div class="sect3">
<h4 id="_sqlite">1.2.1. SQLite</h4>
<div class="paragraph">
<p>The relational database management system (RDBMS) that we will use is <strong>SQLite</strong>. It is very lightweight and easy to set up.</p>
</div>
<div class="sect4">
<h5 id="_using_sqlite_on_the_linux_command_line">Using SQLite on the linux command line</h5>
<div class="paragraph">
<p>To create a new database that you want to give the name 'new_database.sqlite', just call <code>sqlite3</code> with the new database name. <code>sqlite3 new_database.sqlite</code> The name of that file does not have to end with <code>.sqlite</code>, but it helps you to remember that this is an SQLite database. If you add tables and data in that database and quit, the data will automatically be saved.</p>
</div>
<div class="paragraph">
<p>There are two types of commands that you can run within SQLite: <strong>SQL commands</strong> (the same as in any other relational database management system), and <strong>SQLite-specific commands</strong>. The latter start with a period, and do <strong>not</strong> have a semi-colon at the end, in contrast to SQL commands (see later).</p>
</div>
<div class="paragraph">
<p>Some useful commands:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.help</code> &#8658; Returns a list of the SQL-specific commands</p>
</li>
<li>
<p><code>.tables</code> &#8658; Returns a list of tables in the database</p>
</li>
<li>
<p><code>.schema</code> &#8658; Returns the schema of all tables</p>
</li>
<li>
<p><code>.header on</code> &#8658; Add a header line in any output</p>
</li>
<li>
<p><code>.mode column</code> &#8658; Align output data in columns instead of output as comma-separated values</p>
</li>
<li>
<p><code>.quit</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_using_db_browser_for_sqlite">Using DB Browser for SQLite</h5>
<div class="paragraph">
<p>If you like to use a graphical user interface (or don&#8217;t work on a linux or OSX computer), you can use the DB Browser for SQLite which you can download [here](<a href="https://sqlitebrowser.org/" class="bare">https://sqlitebrowser.org/</a>).</p>
</div>
<div class="paragraph">
<p>Note: In all code snippets that follow below, the <code>sqlite&gt;</code> at the front represents the sqlite prompt, and should <strong>not</strong> be typed in&#8230;&#8203;</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_database_schema_and_normalisation">1.3. Database schema and normalisation</h3>
<div class="paragraph">
<p>We’ll look into two examples to guide us through developing a good database schema. The database schema is basically the description of what the database looks like: what are the names of the tables, what are the columns in those tables, and how are these connected between tables?</p>
</div>
<div class="sect3">
<h4 id="_a_student_database">1.3.1. A student database</h4>
<div class="sect4">
<h5 id="_the_simplest_version">The simplest version</h5>
<div class="paragraph">
<p>Let&#8217;s say we want to store which students follow the S&amp;DM course. We want to keep track of their first name, last name, student ID, and whether or not they follow the course. This should allow for some easy queries, such as listing all people who take the course, or returning the number of people who do so.
In this case, a <em>flat database</em> would suffice; i.e. a <em>single</em> table can hold all information.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">first_name</th>
<th class="tableblock halign-left valign-top">last_name</th>
<th class="tableblock halign-left valign-top">student_id</th>
<th class="tableblock halign-left valign-top">takes_course</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ANOVA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bayesian</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LDA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sarah</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Smith</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_a_slightly_less_simple_setting">A slightly less simple setting</h5>
<div class="paragraph">
<p>Consider that we want to store which students follow which courses in MSc Statistics. So we&#8217;d like to keep:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>first name, last name, student ID</p>
</li>
<li>
<p>courses a student takes (CPS, LinMod, S&amp;DM, &#8230;&#8203;)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This should allow for queries e.g. to find out which people follow a particular course, the average number of courses a student takes, etc.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take the same approach as above, and we simply add a column for each course.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">first_name</th>
<th class="tableblock halign-left valign-top">last_name</th>
<th class="tableblock halign-left valign-top">student_id</th>
<th class="tableblock halign-left valign-top">takes_GLM</th>
<th class="tableblock halign-left valign-top">takes_SDM</th>
<th class="tableblock halign-left valign-top">takes_CPS</th>
<th class="tableblock halign-left valign-top">&#8230;&#8203;</th>
<th class="tableblock halign-left valign-top">takes_LDA</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sarah</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Smith</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kopals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This way of working (called the <em>wide format</em>) does present some issues, though.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We will end up with a huge table. Imagine there are 20 courses at UHasselt and 80 at other universities in Flanders that the student can follow. In addition, suppose there are 50 students. This would mean that we need (3 + 100)*50 = 5,150 cells to store this data.</p>
</li>
<li>
<p>There can be a lot of wasted space, for example courses that nobody takes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An alternative is to use the <em>long format</em>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">first_name</th>
<th class="tableblock halign-left valign-top">last_name</th>
<th class="tableblock halign-left valign-top">student_id</th>
<th class="tableblock halign-left valign-top">takes_course</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ANOVA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bayesian</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LDA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sarah</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Smith</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This solves the issue of not having to store the information when a course is <em>not</em> taken, decreasing the number of cells needed from 5,150 to 2,000.</p>
</div>
<div class="paragraph">
<p>This is still not ideal though, as this design still suffers from a lot of redundancy: the first name, last name and student ID are provided over and over again. Imagine that we&#8217;d keep home address (street, street number, zip code, city, country) as well, that would look like this:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">first_name</th>
<th class="tableblock halign-left valign-top">last_name</th>
<th class="tableblock halign-left valign-top">student_id</th>
<th class="tableblock halign-left valign-top">street</th>
<th class="tableblock halign-left valign-top">number</th>
<th class="tableblock halign-left valign-top">zip</th>
<th class="tableblock halign-left valign-top">city</th>
<th class="tableblock halign-left valign-top">takes_course</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some Street</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1234</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MajorCity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some Street</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1234</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MajorCity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ANOVA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some Street</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1234</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MajorCity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bayesian</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Van Deun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Main Street</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1234</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallVillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LDA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sarah</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Smith</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S0002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Main Street</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1234</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallVillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>What if Martin Van Deun moves from Some Street 1 in MajorCity to Another Street 42 in AnotherCity? Then we would have to edit all the rows in this table that contain this information, which almost guarantees that you will end up with inconsistencies.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_genotype_database">1.3.2. A genotype database</h4>
<div class="paragraph">
<p>Let&#8217;s look at another example. Let&#8217;s say you want to store individuals and their genotypes. In Excel, you could create a sheet that looks like this with genotypes for 3 polymorphisms in 2 individuals:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1428%;">
<col style="width: 7.1436%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">individual</th>
<th class="tableblock halign-left valign-top">ethnicity</th>
<th class="tableblock halign-left valign-top">rs12345</th>
<th class="tableblock halign-left valign-top">rs12345_amb</th>
<th class="tableblock halign-left valign-top">chr_12345</th>
<th class="tableblock halign-left valign-top">pos_12345</th>
<th class="tableblock halign-left valign-top">rs98765</th>
<th class="tableblock halign-left valign-top">rs98765_amb</th>
<th class="tableblock halign-left valign-top">chr_98765</th>
<th class="tableblock halign-left valign-top">pos_98765</th>
<th class="tableblock halign-left valign-top">rs28465</th>
<th class="tableblock halign-left valign-top">rs28465_amb</th>
<th class="tableblock halign-left valign-top">chr_28465</th>
<th class="tableblock halign-left valign-top">pos_28465</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Let&#8217;s actually create this database using the sqlite DB Browser mentioned above.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/dbbrowser_main.png" alt="dbbrowser main"></span></p>
</div>
<div class="paragraph">
<p>We first select <code>New database</code> and after giving it a name, click <code>Create table</code>. This is where we&#8217;ll describe what the columns should be.</p>
</div>
<div class="paragraph">
<p>We create a table called <code>genotypes</code> with the following columns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>individual</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>ethnicity</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>rs12345</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>rs12345_amb</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>chr_12345</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>pos_12345</code> of type <code>INTEGER</code></p>
</li>
<li>
<p><code>rs98765</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>rs98765_amb</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>chr_98765</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>pos_98765</code> of type <code>INTEGER</code></p>
</li>
<li>
<p><code>rs28465</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>rs28465_amb</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>chr_28465</code> of type <code>TEXT</code></p>
</li>
<li>
<p><code>pos_28465</code> of type <code>INTEGER</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We should now see the following:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/dbbrowser_1.png" alt="dbbrowser 1"></span></p>
</div>
<div class="paragraph">
<p>This table can also be created using the following SQL command (more on this later):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE TABLE genotypes (individual STRING,
                        ethnicity STRING,
                        rs12345 STRING,
                        rs12345_amb STRING,
                        chr_12345 STRING,
                        pos_12345 INTEGER,
                        rs98765 STRING,
                        rs98765_amb STRING,
                        chr_98765 STRING,
                        pos_98765 INTEGER,
                        rs28465 STRING,
                        rs28465_amb STRING,
                        chr_28465 STRING,
                        pos_28465 INTEGER);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This only sets up the structure. We still need to actually load the data for these two individuals. We will use SQL <code>INSERT</code> statements for this. Click on <code>Execute SQL</code>, paste the code below, and run it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO genotypes (individual,
                       ethnicity,
                       rs12345,
                       rs12345_amb,
                       chr_12345,
                       pos_12345,
                       rs98765,
                       rs98765_amb,
                       chr_98765,
                       pos_98765,
                       rs28465,
                       rs28465_amb,
                       chr_28465,
                       pos_28465)
           VALUES ('individual_A','caucasian','A/A','A','1',12345, 'A/G','R','1',98765, 'G/T','K','5',28465);
INSERT INTO genotypes (individual,
                       ethnicity,
                       rs12345,
                       rs12345_amb,
                       chr_12345,
                       pos_12345,
                       rs98765,
                       rs98765_amb,
                       chr_98765,
                       pos_98765,
                       rs28465,
                       rs28465_amb,
                       chr_28465,
                       pos_28465)
            VALUES ('individual_B','caucasian','A/C','M','1',12345, 'G/G','G','1',98765, 'G/G','G','5',28465);</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/dbbrowser_2.png" alt="dbbrowser 2"></span></p>
</div>
<div class="paragraph">
<p>Note that every SQL command is ended with a <strong>semi-colon</strong>&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>We can now check that everything is loaded by clicking on <code>Browse Data</code> (we&#8217;ll come back to getting data out later):</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/dbbrowser_3.png" alt="dbbrowser 3"></span></p>
</div>
<div class="paragraph">
<p>Done! For every new SNP we just add a new column, right? Wrong&#8230;&#8203; In contrast to the student example above where there are - let&#8217;s say - 100 courses, a genotyping experiment can return results for <em>millions</em> of positions. Imaging having a table with millions of columns.</p>
</div>
</div>
<div class="sect3">
<h4 id="_normal_forms">1.3.3. Normal forms</h4>
<div class="paragraph">
<p>There are some good practices in developing relational database schemes which make it easier to work with the data afterwards. Some of these practices are represented in the "normal forms".</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider the following table listing individuals, SNPs and genotypes. This is genetic data. As you know, everyone has very similar DNA (otherwise we wouldn&#8217;t be human), but there are a lot of positions in that genome (about 1/1000) where people differ from each other (otherwise we would all be clones). A "single nucleotide polymorphism" (or "SNP") is such a position in the genome. A "genotype" is the actual nucleotides that someone has in his/her genome at that particular position. And because we have 2 copies of each chromosome, a genotype consists of 2 letters (A, C, G and T).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1112%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">individual</th>
<th class="tableblock halign-left valign-top">ethnicity</th>
<th class="tableblock halign-left valign-top">rs12345</th>
<th class="tableblock halign-left valign-top">chromosome;position</th>
<th class="tableblock halign-left valign-top">rs12345_diseases</th>
<th class="tableblock halign-left valign-top">rs98765</th>
<th class="tableblock halign-left valign-top">chromosome;position</th>
<th class="tableblock halign-left valign-top">rs28465</th>
<th class="tableblock halign-left valign-top">chromosome;position</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1;12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COPD;asthma</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1;98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5;28465</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1;12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COPD;asthma</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1;98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5;28465</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_first_normal_form">First normal form</h5>
<div class="paragraph">
<p>To get to the first normal form:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Make columns atomic</strong>: a single cell should contain only a single value</p>
</li>
<li>
<p><strong>Values in a column should be of a single domain</strong>: a single column should not have a mix of data</p>
</li>
<li>
<p><strong>All columns should have unique names</strong></p>
</li>
<li>
<p><strong>Columns should be not be hidden lists</strong>: often clear because the column <em>name</em> actually holds information</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The above table violates several of these points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>rs12345_diseases</code> columns holds non-atomic values: <code>COPD;asthma</code> is a list.</p>
</li>
<li>
<p>The column name <code>chromosome;position</code> is used multiple times.</p>
</li>
<li>
<p>The columns <code>rs12345</code>, <code>rs98765</code> and <code>rs28465</code> are effectively the same thing: they describe the genotypes for a particular SNP. The same is true for the <code>chromsome;position</code> columns (but that was already clear from the previous point).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The solution to these issues is to go from a <em>wide</em> format to a <em>long</em> format: remove columns by adding rows. For example, the information for the 3 different SNPs is now stored in different rows instead of different columns. The same is true for the non-atomic values: we just duplicate the row to be able to split up the diseases. This will end up with many rows but don&#8217;t worry about that.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">individual</th>
<th class="tableblock halign-left valign-top">ethnicity</th>
<th class="tableblock halign-left valign-top">snp</th>
<th class="tableblock halign-left valign-top">genotype</th>
<th class="tableblock halign-left valign-top">chr</th>
<th class="tableblock halign-left valign-top">pos</th>
<th class="tableblock halign-left valign-top">disease</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COPD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asthma</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COPD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asthma</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The new schema:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/1NF.png" alt="1NF"></span></p>
</div>
<div class="paragraph">
<p>Everything is still contained in a single table, which will change when we go to the second normal form.</p>
</div>
</div>
<div class="sect4">
<h5 id="_second_normal_form">Second normal form</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Schema is in First Normal form</strong></p>
</li>
<li>
<p><strong>There are no partial dependencies</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the new table above, we see that there are several columns that are 1-to-1 dependent on another column. For example, if we know the individual, we know their ethnicity. If we know the SNP, we know the chromosome, position and any diseases involved. For the 2nd normal form, we extract these into separate tables. In doing this, think about the <em>concepts</em> that you&#8217;re trying to separate.</p>
</div>
<div class="paragraph">
<p><code>genotypes</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">individual_id</th>
<th class="tableblock halign-left valign-top">snp_id</th>
<th class="tableblock halign-left valign-top">genotype</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/C</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/C</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/T</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>individuals</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">ethnicity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>snps</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">chr</th>
<th class="tableblock halign-left valign-top">pos</th>
<th class="tableblock halign-left valign-top">diseases</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COPD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asthma</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Some observations (and good practices):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The name of each table should be <strong>plural</strong> (not mandatory, but good practice).</p>
</li>
<li>
<p>Each table should have a <strong>primary key</strong>, ideally named <code>id</code>. Different tables can contain columns that have the same name; column names should be unique within a table, but can occur across tables.</p>
</li>
<li>
<p>In the <code>genotypes</code> table, individuals are identified by their <code>id</code> in the <code>individuals</code> table which is their primary key. The <code>individual_id</code> column in the <code>genotypes</code> table is called the <strong>foreign key</strong>. Again best practice: if a foreign key refers to the <code>id</code> column in the <code>individuals</code> table, it should be named <code>individual_id</code> (note the singular).</p>
</li>
<li>
<p>The name of each table should be plural (not mandatory, but good practice).</p>
</li>
<li>
<p>The foreign key <code>individual_id</code> in the <code>genotypes</code> table must be of the same type as the <code>id</code> column in the <code>individuals</code> table.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By the way, we see that the first 2 rows in the <code>genotypes</code> table are exactly the same apart from the unique ID, and the same is true for rows 3 and 4, so we can remove one for each (e.g. the ones with ID <code>2</code> and <code>4</code>).</p>
</div>
<div class="paragraph">
<p><code>genotypes</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">individual_id</th>
<th class="tableblock halign-left valign-top">snp_id</th>
<th class="tableblock halign-left valign-top">genotype</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/C</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/T</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The new schema:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/2NF.png" alt="2NF"></span></p>
</div>
</div>
<div class="sect4">
<h5 id="_third_normal_form">Third normal form</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Look for rows that are the same except for a non-key column</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the <code>snps</code> table above, there are two rows that are exactly the same (not taking into account the <code>id</code> column), if it weren&#8217;t for the <code>disease</code> field.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">1</th>
<th class="tableblock halign-left valign-top">rs12345</th>
<th class="tableblock halign-left valign-top">1</th>
<th class="tableblock halign-left valign-top">12345</th>
<th class="tableblock halign-left valign-top">COPD</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asthma</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Such case indicates a one-to-many or many-to-many relationship: a single SNP can be involved in multiple diseases. Again we have duplication here: the fact that SNP <code>rs12345</code> is on chromosome 1 at position 12345 is captured twice. We can solve this by extracting another table, called <code>diseases</code>.</p>
</div>
<div class="paragraph">
<p>Although biologically incorrect, imagine that a disease can only be linked to a single SNP. This would be a one-to-many relationship: one SNP to many diseases. In that case we could create the following tables:</p>
</div>
<div class="paragraph">
<p><code>snps</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">chr</th>
<th class="tableblock halign-left valign-top">pos</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>diseases</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">snp_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COPD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asthma</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>We have now eliminated the <code>disease</code> column from the <code>snps</code> table so end up with 2 identical rows (rows 1 and 2) and can remove one of them.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">chr</th>
<th class="tableblock halign-left valign-top">pos</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>But as we just mentioned, biologically speaking a single SNP can be involved in multiple diseases and a single disease can be influenced by multiple SNPs. This is a <em>many-to-many</em> relationship. In this case, we can&#8217;t just add a <code>snp_id</code> to the <code>diseases</code> table anymore (or you would have to use a non-atomic field which would violate the 1st normal form). You typically create a separate <em>link table</em>.</p>
</div>
<div class="paragraph">
<p><code>snps</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">chr</th>
<th class="tableblock halign-left valign-top">pos</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>diseases</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COPD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asthma</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>disease2snp</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">snp_id</th>
<th class="tableblock halign-left valign-top">disease_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_the_final_database">The final database</h6>
<div class="paragraph">
<p>In the end, we have the following tables:</p>
</div>
<div class="paragraph">
<p><code>snps</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">chr</th>
<th class="tableblock halign-left valign-top">pos</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>diseases</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COPD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asthma</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>disease2snp</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">snp_id</th>
<th class="tableblock halign-left valign-top">disease_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>genotypes</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">individual_id</th>
<th class="tableblock halign-left valign-top">snp_id</th>
<th class="tableblock halign-left valign-top">genotype</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/C</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A/G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/T</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G/G</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>individuals</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">ethnicity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The schema itself:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/3NF.png" alt="3NF"></span></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_types_of_table_relationships">Types of table relationships</h5>
<div class="paragraph">
<p>To come back to the one-to-many relationships&#8230;&#8203; So how do you know in which table to create the foreign key? Should there be an <code>individual_id</code> in the <code>genotypes</code> table? Or a <code>genotype_id</code> in the <code>individuals</code> table? That all depends on the <strong>type of relationship</strong> between two tables. This type can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>one-to-one</strong>, for example an single ISBN number can be linked to a single book and vice versa.</p>
</li>
<li>
<p><strong>one-to-many</strong>, for example a single company will have many employees, but a single employee will work only for a single company</p>
</li>
<li>
<p><strong>many-to-many</strong>, for example a single book can have multiple authors and a single author can have written multiple books</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One-to-many is obviously the same as many-to-one but looking at it from the other direction&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>When you have a <em>one-to-one relationship</em>, you can actually merge that information into the same table so in the end you won&#8217;t even need a foreign key. In the book example mentioned above, you&#8217;d just add the ISBN number to the books table.&lt;br/&gt;
When you have a <em>one-to-many relationship</em>, you&#8217;d add the foreign key to the "many" table. In the example below a <em>single company</em> will have <em>many employees</em>, so you add the foreign key in the employees table.</p>
</div>
<div class="paragraph">
<p>The <code>companies</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">company_name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Big company 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Big company 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Big company 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>employees</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">address</th>
<th class="tableblock halign-left valign-top">company_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">John Jones</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">some_address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">some_city</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jim James</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">another_address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">some_city</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fred Fredricks</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">yet_another_address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">another_city</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When you have a <em>many-to-many relationship</em> you&#8217;d typically extract that information into a new table. For the books/authors example, you&#8217;d have a single table for the books, a single table for the authors, and a separate table that links the two together. That "linking" table can also contain information that is specific for that relationship, but it does not have to. An example is the <code>genotypes</code> table above. There are many SNPs for a single individual, and a single SNP is measured for many individuals. That&#8217;s why we created a separate table called <code>genotypes</code>, which in this case has additional columns that denote the value for a single individual for a single SNP. For the books/authors example, this would be:</p>
</div>
<div class="paragraph">
<p>The <code>books</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">title</th>
<th class="tableblock halign-left valign-top">ISBN13</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Good Omens: The Nice and Accurate Prophecies of Agnes Nutter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Witch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9780060853983</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Going Postal (Discworld #33)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9780060502935</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Small Gods (Discworld #13)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9780552152976</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Stupidest Angel: A Heartwarming Tale of Christmas Terror</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9780060842352</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>authors</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terry Pratchett</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Christopher Moore</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neil Gaiman</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>author2book</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">author_id</th>
<th class="tableblock halign-left valign-top">book_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The information in these tables says that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Terry Pratchett and Neil Gaiman co-wrote "Good Omens"</p>
</li>
<li>
<p>Terry Pratchett wrote "Going Postal" and "Small Gods" by himself</p>
</li>
<li>
<p>Christopher Moore was the single authors of "The Stupidest Angel"</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_other_best_practices">1.3.4. Other best practices</h4>
<div class="paragraph">
<p>There are some additional guidelines that you can use in creating your database schema, although different people use different guidelines. Everyone ends up with their own approach. What <em>I</em> do:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>No capitals</strong> in table or column names</p>
</li>
<li>
<p>Every <strong>table name</strong> is <strong>plural</strong> (e.g. <code>genes</code>)</p>
</li>
<li>
<p>The <strong>primary key</strong> of each table should be <code>id</code></p>
</li>
<li>
<p>Any <strong>foreign key</strong> should be the <strong>singular of the table name, plus "_id"</strong>. So for example, a genotypes table can have a sample_id column which refers to the id column of the samples table.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In some cases, I digress from the rule of "every table name is plural", especially if a table is really meant to link to other tables together. A table genotypes which has an id, sample_id, snp_id, and genotype could e.g. also be called <code>sample2snp</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_referential_integrity">1.3.5. Referential integrity</h4>
<div class="paragraph">
<p>In a SQL database, it is important that there are no tables that contain a foreign key which cannot be resolved. For example in the <code>genotypes</code> table above, there should not be a row where the <code>individual_id</code> is <code>9</code> because there does not exist a record in the <code>individuals</code> table with an <code>id</code> of <code>9</code>.</p>
</div>
<div class="paragraph">
<p>This might occur when you originally have that record in the <code>individuals</code> table, but removed it (either accidentally or on purpose). Large database management systems like Oracle actually will complain when you try to do that, and do not allow you to remove that row before any row referencing it in another table is removed first. As SQLite is lightweight, however, you will have to take care of this yourself.</p>
</div>
<div class="paragraph">
<p>This also means that when loading data, you should first load the <code>individuals</code> and <code>snps</code> tables, and only load the <code>genotypes</code> table afterwards, because the ids of the specific individuals and snps is otherwise not known yet.</p>
</div>
</div>
<div class="sect3">
<h4 id="_indices">1.3.6. Indices</h4>
<div class="paragraph">
<p>There might be columns that you will often use for filtering. For example, you expect to regularly run queries that include a filter on ethnicity. To speed things up you can create an index on that column.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE INDEX idx_ethnicity ON genotypes (ethnicity);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sql_structured_query_language">1.4. SQL - Structured Query Language</h3>
<div class="paragraph">
<p>Any interaction with data in RDBMS can happen through the Structured Query Language (SQL): create tables, insert data, search data, &#8230;&#8203; There are two subparts of SQL:</p>
</div>
<div class="paragraph">
<p><strong><strong>DDL - Data Definition Language:</strong></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE DATABASE test;
CREATE TABLE snps (id INT PRIMARY KEY AUTOINCREMENT, accession STRING, chromosome STRING, position INTEGER);
ALTER TABLE...
DROP TABLE snps;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For examples: see above.</p>
</div>
<div class="paragraph">
<p><strong><strong>DML - Data Manipulation Language:</strong></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT
UPDATE
INSERT
DELETE</code></pre>
</div>
</div>
<div class="paragraph">
<p>Some additional functions are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">DISTINCT
COUNT(*)
COUNT(DISTINCT column)
MAX(), MIN(), AVG()
GROUP BY
UNION, INTERSECT</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ll look closer at getting data into a database and then querying it, using these four SQL commands.</p>
</div>
<div class="sect3">
<h4 id="_getting_data_in">1.4.1. Getting data in</h4>
<div class="sect4">
<h5 id="_insert_into">INSERT INTO</h5>
<div class="paragraph">
<p>There are several ways to load data into a database. The method used above is the most straightforward but inadequate if you have to load a large amount of data.</p>
</div>
<div class="paragraph">
<p>It&#8217;s basically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO &lt;table_name&gt; (&lt;column_1&gt;, &lt;column_2&gt;, &lt;column_3&gt;)
                         VALUES (&lt;value_1&gt;, &lt;value_2&gt;, &lt;value_3&gt;);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_importing_a_datafile">Importing a datafile</h5>
<div class="paragraph">
<p>But this becomes an issue if you have to load 1,000s of records. Luckily, it&#8217;s possible to load data from a <strong>comma-separated file</strong> straight into a table. Suppose you want to load 3 more individuals, but don&#8217;t want to type the insert commands straight into the sql prompt. Create a file (e.g. called <code>data.csv</code>) that looks like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>individual_C,african
individual_D,african
individual_C,asian</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_using_db_browser">Using DB Browser</h5>
<div class="paragraph">
<p>Using the DB Browser, you can just go to <code>File</code> &#8594; <code>Import</code> &#8594; <code>Table from CSV File&#8230;&#8203;</code>. Note that when you import a file like that, the system will automatically create the <code>rowid</code> column that will serve as the primary key.</p>
</div>
</div>
<div class="sect4">
<h5 id="_on_the_command_line">On the command line</h5>
<div class="paragraph">
<p>SQLite contains a <code>.import</code> command to load this type of data. Syntax: <code>.import &lt;file&gt; &lt;table&gt;</code>. So you could issue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">.separator ','
.import data.csv individuals</code></pre>
</div>
</div>
<div class="paragraph">
<p>Aargh&#8230;&#8203; We get an <strong>error</strong>!</p>
</div>
<div class="paragraph">
<p><code>Error: data.tsv line 1: expected 3 columns of data but found 2</code></p>
</div>
<div class="paragraph">
<p>This is because the table contains an <strong>ID column</strong> that is used as primary key and that increments automatically. Unfortunately, SQLite cannot work around this issue automatically. One option is to add the new IDs to the text file and import that new file. But we don&#8217;t want that, because it screws with some internal counters (SQLite keeps a counter whenever it autoincrements a column, but this counter is not adjusted if you hardwire the ID). A possible <strong>workaround</strong> is to create a temporary table (e.g. <code>individuals_tmp</code>) without the id column, import the data in that table, and then copy the data from that temporary table to the real individuals.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">.schema individuals
CREATE TABLE individuals_tmp (name STRING, ethnicity STRING);
.separator ','
.import data.csv individuals_tmp
INSERT INTO individuals (name, ethnicity) SELECT * FROM individuals_tmp;
DROP TABLE individuals_tmp;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your <code>individuals</code> table should now look like this (using <code>SELECT * FROM individuals;</code>):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">ethnicity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">african</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">african</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asian</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_getting_data_out">1.4.2. Getting data out</h4>
<div class="paragraph">
<p>It may seem counter-intuitive to first break down the data into multiple tables using the normal forms as described above, in order to having to combine them afterwards again in a SQL query. The reason for this is simple: it allows you to ask the data any question much more easily, instead of being restricted to the format of the original data.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/normalisation-queries.png" alt="normalisation queries"></span></p>
</div>
<div class="sect4">
<h5 id="_queries">Queries</h5>
<div class="paragraph">
<p>Why do we need queries? Because natural languages (e.g. English) are too vague: with complex questions, it can be hard to verify that the question
was interpreted correctly, and that the answer we received is truly
correct. The Structured Query Language (SQL) is a standardised system so that users and developers can learn one method that works on (almost) any system.</p>
</div>
<div class="paragraph">
<p>In order to write your queries, you&#8217;ll need to know what the database looks like. A <em>relationship diagram</em> including tables, columns and relations is very helpful here. See for example this relationship diagram for a pet store.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/relationship-diagram.png" alt="relationship diagram"></span></p>
</div>
<div class="paragraph">
<p>Questions that we can ask the database include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Which animals were born after August 1?</p>
</li>
<li>
<p>List the animals by category and breed.</p>
</li>
<li>
<p>List the categories of animals that are in the Animal list.</p>
</li>
<li>
<p>Which dogs have a donation value greater than $250?</p>
</li>
<li>
<p>Which cats have black in their color?</p>
</li>
<li>
<p>List cats excluding those that are registered or have red in their color.</p>
</li>
<li>
<p>List all dogs who are male and registered or who were born before 01-June-2010 and have white in their color.</p>
</li>
<li>
<p>What is the extended value (price * quantity) for sale items on sale 24?</p>
</li>
<li>
<p>What is the average donation value for animals?</p>
</li>
<li>
<p>What is the total value of order number 22?</p>
</li>
<li>
<p>How many animals were adopted in each category?</p>
</li>
<li>
<p>How many animals were adopted in each category with total adoptions of more than 10?</p>
</li>
<li>
<p>How many animals born after June 1 were adopted in each category with total adoptions more than 10?</p>
</li>
<li>
<p>List the CustomerID of everyone who bought or adopted something between April 1, 2010 and May 31, 2010.</p>
</li>
<li>
<p>List the names of everyone who bought or adopted something between April 1, 2010 and May 31, 2010.</p>
</li>
<li>
<p>List the name and phone number of anyone who adopted a registered white cat between two given dates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Similarly, we already drew the relationship diagram for the genotypes.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/primary_foreign_keys.png" alt="primary foreign keys"></span></p>
</div>
<div class="paragraph">
<p>Questions that we can ask:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What is the number of individuals for each ethnicity?</p>
</li>
<li>
<p>How many SNPs are there per chromosome?</p>
</li>
<li>
<p>Approximately how long is chromosome 22 (by looking at the maximum SNP position)?</p>
</li>
<li>
<p>What are the most/least common genotypes?</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_single_tables">Single tables</h6>
<div class="paragraph">
<p>It is very simple to query a single table. The <strong>basic syntax</strong> is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT &lt;column_name1, column_name2&gt; FROM &lt;table_name&gt; WHERE &lt;conditions&gt;;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to see <strong>all columns</strong>, you can use "*" instead of a list of column names, and you can leave out the WHERE clause. The <strong>simplest query</strong> is therefore <code>SELECT * FROM &lt;table_name&gt;;</code>. So <strong>the <code>&lt;column_name1, column_name2&gt;</code>  slices the table vertically while the WHERE clause slices it horizontally</strong>.</p>
</div>
<div class="paragraph">
<p>Data can be filtered using a <code>WHERE</code> clause. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM individuals WHERE ethnicity = 'african';
SELECT * FROM individuals WHERE ethnicity = 'african' OR ethnicity = 'caucasian';
SELECT * FROM individuals WHERE ethnicity IN ('african', 'caucasian');
SELECT * FROM individuals WHERE ethnicity != 'asian';</code></pre>
</div>
</div>
<div class="paragraph">
<p>What if you can&#8217;t remember if the ethnicity was stored capitalised or not? In other words: was it 'caucasian' or 'Caucasian'? One way of approaching this is using the <strong><code>LIKE</code></strong> keyword. It behaves the same as <code>==</code>, but you can use wildcards (i.c. <code>%</code>) that can represent any character. For example, the following two are almost the same:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM individuals WHERE ethnicity == 'Caucasian' OR ethnicity == 'caucasian';
SELECT * FROm individuals WHERE ethnicity LIKE '%aucasian';</code></pre>
</div>
</div>
<div class="paragraph">
<p>I say "almost" the same, because the <code>%</code> can stand for more than one character. A <code>WHERE ethnicity LIKE '%sian'</code> would therefore return those individuals who are "Caucasian", "caucasian", "Asian" and "asian".</p>
</div>
<div class="paragraph">
<p>You often just want to see a <strong>small subset of data</strong> just to make sure that you&#8217;re looking at the right thing. In that case: add a <code>LIMIT</code> clause to the end of your query, which has the same effect as using <code>head</code> on the linux command-line. Please <strong>always</strong> do this if you don&#8217;t know what your table looks like because you don&#8217;t want to send millions of lines to your screen.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM individuals LIMIT 5;
SELECT * FROM individuals WHERE ethnicity = 'caucasian' LIMIT 1;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you just want know the <strong>number of records</strong> that would match your query, use <code>COUNT(*)</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT COUNT(*)
FROM individuals
WHERE ethnicity = 'african';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the <code>GROUP BY</code> clause you can <strong>aggregate</strong> data. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT ethnicity, COUNT(*)
FROM individuals
GROUP BY ethnicity;</code></pre>
</div>
</div>
<div class="paragraph">
<p>======= Combining tables</p>
</div>
<div class="paragraph">
<p>In the second normal form we separated several aspects of the data in different tables. Ultimately, we want to combine that information of course. This is where the primary and foreign keys come in. Suppose you want to list all different SNPs, with the alleles that have been found in the population:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT individual_id, snp_id, genotype_amb
FROM genotypes;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This isn&#8217;t very informative, because we get the uninformative numbers for SNPs instead of SNP accession numbers. To run a query across tables, we have to call both tables in the FROM clause:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT individuals.name, snps.accession, genotypes.genotype_amb
FROM individuals, snps, genotypes;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">accession</th>
<th class="tableblock halign-left valign-top">genotype_amb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Wait&#8230;&#8203; This can&#8217;t be correct: we get 36 rows back instead of the 6 that we expected. This is because <em>all</em> combinations are made between <em>all</em> rows of each table. We have to put some constraints on the rows that are returned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT individuals.name, snps.accession, genotypes.genotype_amb
FROM individuals, snps, genotypes
WHERE individuals.id = genotypes.individual_id
AND snps.id = genotypes.snp_id;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">accession</th>
<th class="tableblock halign-left valign-top">genotype_amb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>What happens here?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The individuals, snps and genotypes tables are referenced in the FROM clause.</p>
</li>
<li>
<p>In the SELECT clause, we tell the query what columns to return. We <strong>prepend the column names with the table name</strong>, to know what column we actually mean (snps.id is a different column from individuals.id).</p>
</li>
<li>
<p><strong>In the WHERE clause, we actually provide the link between the tables</strong>: the value for snp_id in the genotypes table should correspond with the id column in the snps table. This is the part that solves the above issue of returning all those nonsense rows. Imagine that we&#8217;d ask the id&#8217;s themselves as well, then we&#8217;d get the list below. From that list, we can then filter the rows that adhere to the constraints we set.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT individuals.id, genotypes.individual_id, snps.id, genotypes.snp_id, individuals.name, snps.accession, genotypes.genotype_amb
FROM individuals, snps, genotypes;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">individual.id</th>
<th class="tableblock halign-left valign-top">genotypes.individual_id</th>
<th class="tableblock halign-left valign-top">snps.id</th>
<th class="tableblock halign-left valign-top">genotypes.snp_id</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">accession</th>
<th class="tableblock halign-left valign-top">genotype_amb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>individual_A</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rs12345</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>A</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs12345</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>R</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-3-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs12345</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>K</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs12345</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>M</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs12345</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>G</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-3-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs12345</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>G</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs98765</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>A</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>individual_A</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rs98765</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>R</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-3-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs98765</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>K</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs98765</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>M</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>2</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>2</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs98765</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>G</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-3-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs98765</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>G</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-3-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs28465</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>A</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-3-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs28465</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>R</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>individual_A</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rs28465</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>K</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-3-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs28465</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>M</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-3-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs28465</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>G</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>3</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>3</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs28465</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>G</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>1</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_B</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs12345</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>A</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_B</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs12345</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>R</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-2-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-1-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>-3-</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>individual_B</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs12345</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>K</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>individual_B</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rs12345</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>M</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Having to type the table names in front of the column names can become tiresome. We can however create <strong>aliases</strong> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT i.name, s.accession, g.genotype_amb
FROM individuals i, snps s, genotypes g
WHERE i.id = g.individual_id
AND s.id = g.snp_id;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_join">JOIN</h6>
<div class="paragraph">
<p>Sometimes, though, we have to join tables in a different way. Suppose that our snps table contains SNPs that are nowhere mentioned in the genotypes table, but we still want to have them mentioned in our output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO snps (accession, chromosome, position) VALUES ('rs11223','2',11223);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT s.accession, s.chromosome, s.position, g.genotype_amb
FROM snps s, genotypes g
WHERE s.id = g.snp_id
ORDER BY s.accession, g.genotype_amb;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We get the following output:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">chromosome</th>
<th class="tableblock halign-left valign-top">position</th>
<th class="tableblock halign-left valign-top">accession</th>
<th class="tableblock halign-left valign-top">genotype_amb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>But we actually want to have rs11223 in the list as well. Using this approach, we can&#8217;t because of the <code>WHERE s.id = g.snp_id</code> clause. The solution to this is to use an <strong>explicit join</strong>. To make things complicated, there are several types: inner and outer joins. In principle, an inner join gives the result of the intersect between two tables, while an outer join gives the results of the union. What we&#8217;ve been doing up to now is look at the intersection, so the approach we used above is equivalent to an inner join:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT s.accession, g.genotype_amb
FROM snps s INNER JOIN genotypes g ON s.id = g.snp_id
ORDER BY s.accession, g.genotype_amb;</code></pre>
</div>
</div>
<div class="paragraph">
<p>gives:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">accession</th>
<th class="tableblock halign-left valign-top">genotype_amb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A <strong>left outer join</strong> returns all records from the left table, and will include any matches from the right table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT s.accession, g.genotype_amb
FROM snps s LEFT OUTER JOIN genotypes g ON s.id = g.snp_id
ORDER BY s.accession, g.genotype_amb;</code></pre>
</div>
</div>
<div class="paragraph">
<p>gives:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">accession</th>
<th class="tableblock halign-left valign-top">genotype_amb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs11223</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>(Notice the extra line for rs11223!)</p>
</div>
<div class="paragraph">
<p>A full outer join, finally, return all rows from the left table, and all rows from the right table, matching any rows that should be.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_export_to_file">Export to file</h5>
<div class="paragraph">
<p>Often you will want to export the output you get from an SQL-query to a file (e.g. CSV) on your operating system so that you can use that data for external analysis in R or for visualisation. This is easy to do. Suppose that we want to export the first 5 lines of the snps table into a file called <code>5_snps.csv</code>.</p>
</div>
<div class="sect5">
<h6 id="_using_db_browser_2">Using DB Browser</h6>
<div class="paragraph">
<p>There&#8217;s a button for that&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/dbbrowser_4.png" alt="dbbrowser 4"></span></p>
</div>
</div>
<div class="sect5">
<h6 id="_on_the_command_line_2">On the command line</h6>
<div class="paragraph">
<p>You do that like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">.header on
.mode csv
.once 5_snps.csv
SELECT * FROM snps LIMIT 5;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you now exit the sqlite prompt (with <code>.quit</code>), you should see a file in the directory where you were that is called <code>5_snps.csv</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_updating_and_deleting_data">1.4.3. Updating and deleting data</h4>
<div class="paragraph">
<p>Sometimes you will want to update or delete data in a table. The SQL code to do this uses a <code>WHERE</code> clause that is exactly the same as for a regular <code>SELECT</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
First do a <code>SELECT</code> on your table with the <code>WHERE</code> clause that you&#8217;ll use for the update or deletion just to make sure that you&#8217;ll change the correct rows. When you&#8217;ve made changes to the wrong rows you won&#8217;t be able to go back (unless you use the Lambda architecture principles as we will explain in the [third session](<a href="https://vda-lab.github.io/2019/10/lambda-architecture)" class="bare">https://vda-lab.github.io/2019/10/lambda-architecture)</a>).
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_update">UPDATE</h5>
<div class="paragraph">
<p>Imagine that we&#8217;ve been storing the information on our individuals as above, but have not been consistent in capitalising the ethnicity. In some cases, a person can be of <code>asian</code> descent; in other cases he or she can be <code>Asian</code>. The same would go for the other ethnicities. To clean this up, let&#8217;s put everything in lower case. For argument&#8217;s sake we&#8217;ll only look at <code>Asian</code> here. First let&#8217;s check what we should get with a <code>SELECT</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM individuals
WHERE ethnicity == 'Asian';</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will give us the rows that we will change. Are these indeed the ones? Then go forward with the update:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">UPDATE individuals
SET ethnicity = 'asian'
WHERE ethnicity == 'Asian';</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>WHERE</code> clause is the same. The general syntax for an update looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">UPDATE &lt;table&gt;
SET &lt;column&gt; = &lt;new value&gt;
WHERE &lt;conditions&gt;;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example the column that is updated (ethnicity) is the same as the one in the <code>WHERE</code> clause. This does not have to be the case. What would the following do?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">UPDATE genotypes
SET genotype_amb = 'R'
WHERE genotype == 'A/G';</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_delete">DELETE</h5>
<div class="paragraph">
<p><code>DELETE</code> is similar to <code>UPDATE</code> but simpler: you don&#8217;t use the <code>SET</code> pragma. Same as with updating data, make sure that your <code>WHERE</code> clause is correct! Test this with a <code>SELECT</code> beforehand.</p>
</div>
<div class="paragraph">
<p>The general syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">DELETE FROM &lt;table&gt;
WHERE &lt;conditions&gt;;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">DELETE FROM genotypes
WHERE genotype_amb == 'N';</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_additional_functions">1.4.4. Additional functions</h4>
<div class="sect4">
<h5 id="_limit">LIMIT</h5>
<div class="paragraph">
<p>If you only want to get the first 10 results back (e.g. to find out if your complicated query does what it should do without running the whole actual query), use LIMIT:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">sqlite&gt; SELECT * FROM snps LIMIT 2;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_null">NULL</h5>
<div class="paragraph">
<p>SNPs are spread across a chromosome, and might or might not be located within a gene.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/snps_not_in_genes.png" alt="snps not in genes"></span></p>
</div>
<div class="paragraph">
<p>What if you want to search for the SNPs that are not in genes? Imagine that our <code>snps</code> table has an additional column with the gene name, like this:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">accession</th>
<th class="tableblock halign-left valign-top">chromosome</th>
<th class="tableblock halign-left valign-top">position</th>
<th class="tableblock halign-left valign-top">gene</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_B</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs92873</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7382</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs10238</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">291732</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_C</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs92731</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10283</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_C</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>We cannot <code>SELECT * FROM snps WHERE gene = "";</code> because that is searching for an empty string which is not the same as a missing value. To get to rs92873 you can issue <code>SELECT * FROM snps WHERE gene IS NULL;</code> or to get the rest <code>SELECT * FROM snps WHERE GENE IS NOT NULL;</code>. Note that it is <code>IS NULL</code> and <strong>not</strong> <code>= NULL</code>&#8230;&#8203;</p>
</div>
</div>
<div class="sect4">
<h5 id="_and_or">AND, OR</h5>
<div class="paragraph">
<p>Your queries might need to <strong>combine different conditions</strong>, as we&#8217;ve already seen above:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AND</code>: both must be true</p>
</li>
<li>
<p><code>OR</code>: either one is true</p>
</li>
<li>
<p><code>NOT</code>: reverse the value</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM snps WHERE chromosome = '1' AND position &lt; 40000;
SELECT * FROM snps WHERE chromosome = '1' OR chromosome = '5';
SELECT * FROM snps WHERE chromosome = '1' AND NOT position &lt; 40000;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result is affected by the order of the operations. Parentheses indicate that an operation should be performed first. Without parentheses, operations are performed left-to-right.</p>
</div>
<div class="paragraph">
<p>For example, if a = 3, b = -1 and c = 2, then:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(( a &gt; 4 ) AND  ( b &lt; 0 )) OR ( c &gt; 1 )  evaluates to true</p>
</li>
<li>
<p>( a &gt; 4 ) AND (( b &lt; 0 )  OR ( c &gt; 1 )) evaluates to false</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>De Morgan&#8217;s laws apply to SQL. The rules allow the expression of conjunctions and disjunctions purely in terms of each other via negation. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NOT (A AND B)</code> becomes <code>NOT A OR NOT B</code></p>
</li>
<li>
<p><code>NOT (A OR B)</code> becomes <code>NOT A AND NOT B</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_in">IN</h5>
<div class="paragraph">
<p>The <code>IN</code> clause defines a set of values. It is a shortcut to combine several entries with an <code>OR</code> condition.</p>
</div>
<div class="paragraph">
<p>For example, instead of writing</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT *
FROM customer
WHERE first_name = 'Tim'
    OR first_name = 'David'
    OR first_name = 'Jay';</code></pre>
</div>
</div>
<div class="paragraph">
<p>you can use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT *
FROM customer
WHERE first_name IN ('Tim', 'David', 'Jay');</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_distinct">DISTINCT</h5>
<div class="paragraph">
<p>Whenever you want the <strong>unique values</strong> in a column: use DISTINCT in the SELECT clause:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT category FROM animal;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">category</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fish</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fish</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fish</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fish</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT DISTINCT category FROM animal;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">distinct(category)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bird</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fish</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mammal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reptile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spider</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>DISTINCT automatically sorts the results.</p>
</div>
</div>
<div class="sect4">
<h5 id="_order_by">ORDER BY</h5>
<div class="paragraph">
<p>The order by clause allows you to, well, order your output. By default, this is in ascending order. To order from large to small, you can add the <code>DESC</code> tag. It is possible to order by multiple columns, for example first by chromosome and then by position:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM snps ORDER BY chromosome;
SELECT * FROM snps ORDER BY accession DESC;
SELECT * FROM snps ORDER BY chromsome, position;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_count">COUNT</h5>
<div class="paragraph">
<p>For when you want to count things:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT COUNT(*) FROM genotypes WHERE genotype_amb = 'G';</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_max_min_avg">MAX(), MIN(), AVG()</h5>
<div class="paragraph">
<p>&#8230;&#8203;act as you would expect (only works with numbers, obviously):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT MAX(position) FROM snps;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Output is:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">max(position)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">291732</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_as">AS</h5>
<div class="paragraph">
<p>In some cases you might want to rename the output column name. For instance, in the example above you might want to have <code>maximum_position</code> instead of <code>max(position)</code>. The <code>AS</code> keyword can help us with that.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT MAX(position) AS maximum_position FROM snps;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_group_by">GROUP BY</h5>
<div class="paragraph">
<p>GROUP BY can be very useful in that it first <strong>aggregates data</strong>. It is often used together with <code>COUNT</code>, <code>MAX</code>, <code>MIN</code> or <code>AVG</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT genotype_amb, COUNT(*)
FROM genotypes
GROUP BY genotype_amb;

SELECT genotype_amb, COUNT(*) AS c
FROM genotypes
GROUP BY genotype_amb
ORDER BY c DESC;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">genotype_amb</th>
<th class="tableblock halign-left valign-top">c</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT chromosome, MAX(position)
FROM snps
GROUP BY chromosome
ORDER BY chromosome;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">chromosome</th>
<th class="tableblock halign-left valign-top">MAX(position)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11223</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_having">HAVING</h5>
<div class="paragraph">
<p>Whereas the <code>WHERE</code> clause puts conditions on certain columns, the <code>HAVING</code> clause puts these on groups created by <code>GROUP BY</code>.</p>
</div>
<div class="paragraph">
<p>For example, given the following <code>snps</code> table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">accession</th>
<th class="tableblock halign-left valign-top">chromosome</th>
<th class="tableblock halign-left valign-top">position</th>
<th class="tableblock halign-left valign-top">gene</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_B</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs92873</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7382</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs10238</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">291732</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_C</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs92731</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10283</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_C</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT chromosome, count(*) as c
FROM snps
GROUP BY chromosome;</code></pre>
</div>
</div>
<div class="paragraph">
<p>will return</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">chromosome</th>
<th class="tableblock halign-left valign-top">c</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>whereas</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT chromosome, count(*) as c
FROM snps
GROUP BY chromosome
HAVING c &gt; 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>will return</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">chromosome</th>
<th class="tableblock halign-left valign-top">c</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>HAVING</code> clause must follow a <code>GROUP BY</code>, and precede a possible <code>ORDER BY</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_union_intersect">UNION, INTERSECT</h5>
<div class="paragraph">
<p>It is sometimes hard to get the exact rows back that you need using the WHERE clause. In such cases, it might be possible to construct the output based on taking the <strong>union or intersection</strong> of two or more different queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM snps WHERE chromosome = '1';
SELECT * FROM snps WHERE position &lt; 40000;
SELECT * FROM snps WHERE chromosome = '1' INTERSECT SELECT * FROM snps WHERE position &lt; 40000;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">accession</th>
<th class="tableblock halign-left valign-top">chromosome</th>
<th class="tableblock halign-left valign-top">position</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_like">LIKE</h5>
<div class="paragraph">
<p>Sometimes you want to make fuzzy matches. What if you&#8217;re not sure if the ethnicity has a capital or not?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM individuals WHERE ethnicity = 'African';</code></pre>
</div>
</div>
<div class="paragraph">
<p>returns no results&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM individuals WHERE ethnicity LIKE '%frican';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that different databases use different characters as wildcard. For example: <code>%</code> is a wildcard for MS SQL Server representing any string, and <code>*</code> is the corresponding wildcard character used in MS Access. Check the documentation for the RDBMS that you&#8217;re using (sqlite, MySQL/MariaDB, MS SQL Server, MS Access, Oracle, &#8230;&#8203;) for specifics.</p>
</div>
</div>
<div class="sect4">
<h5 id="_subqueries">Subqueries</h5>
<div class="paragraph">
<p>As we mentioned in the beginning, the general setup of a SELECT is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT &lt;column_names&gt;
FROM &lt;table&gt;
WHERE &lt;condition&gt;;</code></pre>
</div>
</div>
<div class="paragraph">
<p>But as you&#8217;ve seen in the examples above, the <strong>output from any SQL query is itself basically a table</strong>. So we can actually <strong>use that output table to run another SELECT</strong>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT *
FROM (
       SELECT *
       FROM snps
       WHERE chromosome IN ('1','5'))
WHERE position &lt; 40000;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course, you can use UNION and INTERSECT in the subquery as well&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>Another example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT COUNT(*)
FROM (
       SELECT DISTINCT genotype_amb
       FROM genotypes);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_public_bioinformatics_databases">1.4.5. Public bioinformatics databases</h4>
<div class="paragraph">
<p>Sqlite is a light-weight system for running relational databases. If you want to make your data available to other people it&#8217;s often better to use systems such as MySQL. The data behind the Ensembl and UCSC genome browsers, for example, is stored in a relational database and directly accessible through SQL as well.</p>
</div>
<div class="paragraph">
<p>If you install a mysql client (see www.mariadb.org or www.mysql.com), you can access these public databases as well. Another option is to run mysql using docker.</p>
</div>
<div class="paragraph">
<p>To access the last release of human from Ensembl: <code>mysql -h ensembldb.ensembl.org -P 5306 -u anonymous homo_sapiens_core_70_37</code>. To get an overview of the tables that we can query: <code>show tables</code>. Using docker this would be <code>docker run -it --rm mysql mysql -h ensembldb.ensembl.org -u anonymous -P 5306 homo_sapiens_core_70_37</code>.</p>
</div>
<div class="paragraph">
<p>To access the <code>hg38</code> release of the UCSC database (which is also a MySQL database): <code>mysql -h genome-mysql.soe.ucsc.edu -ugenome -A hg38</code>. With docker: <code>docker run -it --rm mysql mysql -h genome-mysql.soe.ucsc.edu -u genome -A hg38</code>. You can then for example find out where the gene CYP3A4 is located with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT name, name2, chrom, strand, txStart, txEnd, cdsStart, cdsEnd
FROM refGene
WHERE name2 = 'CYP3A4';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Output will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">mysql&gt; SELECT name, name2, chrom, strand, txStart, txEnd, cdsStart, cdsEnd
    -&gt; FROM refGene
    -&gt; WHERE name2 = 'CYP3A4';
+--------------+--------+-------+--------+----------+----------+----------+----------+
name, name2, chrom, strand, txStart, txEnd, cdsStart, cdsEnd
+--------------+--------+-------+--------+----------+----------+----------+----------+
NM_001202855, CYP3A4, chr7, -, 99756966, 99784184, 99758132, 99784081
NM_017460, CYP3A4, chr7, -, 99756966, 99784184, 99758132, 99784081
+--------------+--------+-------+--------+----------+----------+----------+----------+
2 rows in set (0.16 sec)</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Note: Installing the complete mysql system will install the server and client, and it can be difficult to remove if necessary afterwards. An alternative is to install it using [docker](<a href="http://www.docker.com" class="bare">http://www.docker.com</a>). Run the server with <code>docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:latest</code> and connect to it using <code>docker exec -it some-mysql bash</code>. You can then access the Ensembl and UCSC databases as described above.</em></p>
</div>
</div>
<div class="sect3">
<h4 id="_views">1.4.6. Views</h4>
<div class="paragraph">
<p>By decomposing data into different tables as we described above (and using the different normal forms), we can significantly improve maintainability of our database and make sure that it does not contain inconsistencies. But at the other hand, this means it&#8217;s a lot of hassle to look at the actual data: to know what the genotype is for SNP <code>rs12345</code> in <code>individual_A</code> we cannot just look it up in a single table, but have to write a complicated query which joins 3 tables together. The query would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT i.name, i.ethnicity, s.accession, s.chromosome, s.position, g.genotype_amb
FROM individuals i, snps s, genotypes g
WHERE i.id = g.individual_id
AND s.id = g.snp_id;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Output looks like this:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">ethnicity</th>
<th class="tableblock halign-left valign-top">accession</th>
<th class="tableblock halign-left valign-top">chromosome</th>
<th class="tableblock halign-left valign-top">position</th>
<th class="tableblock halign-left valign-top">genotype_amb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12345</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98765</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">caucasian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28465</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>There is however a way to make this easier: you can create <strong>views</strong> on the data. This basically saves the whole query and gives it a name. You do this by adding <code>CREATE VIEW some_name AS</code> to the front of the query, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE VIEW v_genotypes AS
SELECT i.name, i.ethnicity, s.accession, s.chromosome, s.position, g.genotype_amb
FROM individuals i, snps s, genotypes g
WHERE i.id = g.individual_id
AND s.id = g.snp_id;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can think of this as if you had made a new table with the name <code>v_genotypes</code> that you can use just like any other table, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT *
FROM v_genotypes g
WHERE g.genotype_amb = 'R';</code></pre>
</div>
</div>
<div class="paragraph">
<p>The difference with an actual table is, however, that the result of the view is actually not stored itself. Whenever you do <code>SELECT * FROM v_genotypes</code>, it will actually perform the whole query in the background.</p>
</div>
<div class="paragraph">
<p>Note: to make sure that I can tell by the name if something is a table or a view, I always add a <code>v_</code> in front of the name that I give to the view.</p>
</div>
<div class="sect4">
<h5 id="_pivot_tables">Pivot tables</h5>
<div class="paragraph">
<p>In some cases, you want to violate the 1st normal form, and have different columns represent the same type of data. A typical example is when you want to analyze your data in R using a dataframe. Let&#8217;s say we have expression values for different genes in different individuals. Being good programmers, we saved this data in the database like this:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">individual</th>
<th class="tableblock halign-left valign-top">gene</th>
<th class="tableblock halign-left valign-top">expression</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2819</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1028</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3827</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1928</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">999</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">individual_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1992</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In R, you will however probably want a dataframe that looks like this:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">gene</th>
<th class="tableblock halign-left valign-top">individual_A</th>
<th class="tableblock halign-left valign-top">individual_B</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2819</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1928</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1028</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">999</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gene_C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3827</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1992</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This is called a <strong>pivot table</strong>, and there are several ways to create these in SQLite. The method presented here is taken from <a href="http://bduggan.github.io/virtual-pivot-tables-opensqlcamp2009-talk/" class="bare">http://bduggan.github.io/virtual-pivot-tables-opensqlcamp2009-talk/</a>. To create such table (and store it in a view), you have to use <code>group_concat</code> and <code>group_by</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE VIEW v_pivot_expressions AS
SELECT gene,
       GROUP_CONCAT(CASE WHEN individual = 'individual_A' THEN expression ELSE NULL END) AS individual_A,
       GROUP_CONCAT(CASE WHEN individual = 'individual_B' THEN expression ELSE NULL END) AS individual_B
FROM expressions
GROUP BY gene;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_drawbacks_of_relational_databases">1.5. Drawbacks of relational databases</h3>
<div class="paragraph">
<p>Relational databases are great. They can be a big help in storing and organizing your data. But they are not the ideal solution in all situations.</p>
</div>
<div class="sect3">
<h4 id="_scalability">1.5.1. Scalability</h4>
<div class="paragraph">
<p>Relational databases are only scalable in a limited way. The fact that you try to normalise your data means that your data is distributed over different tables. Any query on that data often requires extensive joins. This is OK, until you have tables with millions of rows. A join can in that case a <strong>very</strong> long time to run.</p>
</div>
<div class="paragraph">
<p>[Although outside of the scope of this lecture.] One solution sometimes used is to go for a star-schema rather than a fully normalised schema. Or using a NoSQL database management system that is horizontally scalable (document-oriented, column-oriented or graph databases).</p>
</div>
</div>
<div class="sect3">
<h4 id="_modeling">1.5.2. Modeling</h4>
<div class="paragraph">
<p>Some types of information are difficult to model when using a relational paradigm. In a relational database, different records can be linked across tables using foreign keys. If you&#8217;re however really interested in the relations themselved (<strong>e.g.</strong> social graphs, protein-protein-interaction, &#8230;&#8203;) you are much better of to use a real graph database (<strong>e.g.</strong> neo4j) instead of a relational database. In a graph database finding all neighbours-of-neighbours in a graph of 50 members (basically) takes as long as in a graph with 50 million members.</p>
</div>
</div>
<div class="sect3">
<h4 id="_drawback_exercise">1.5.3. Drawback exercise</h4>
<div class="paragraph">
<p>Suppose you want to model a social graph. People have names, and know other people. Every "know" is reciprocal (so if I know you then you know me). The data might look like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Tim knows Terry
Tom knows Terry
Terry knows Gerry
Gerry knows Rik
Gerry knows James
James knows John
Fred knows James
Frits knows Fred</pre>
</div>
</div>
<div class="paragraph">
<p>In table format:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">knower</th>
<th class="tableblock halign-left valign-top">knowee</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gerry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gerry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rik</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gerry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">James</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">James</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">John</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fred</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">James</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fred</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gerry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frits</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If you <strong>really</strong> want to have this in a relational database, how would you find out who are the friends of the friends of James? First, we&#8217;d need to find out who James' friends are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT knower FROM friends WHERE knowee = 'James'
UNION
SELECT knowee FROM friends WHERE knower = 'James';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this as a subquery, we can then find out who the friends of those friends are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT knower FROM friends
WHERE knowee IN (
  SELECT knower FROM friends WHERE knowee = 'James'
  UNION
  SELECT knowee FROM friends WHERE knower = 'James'
)
UNION
SELECT knowee FROM friends
WHERE knower IN (
  SELECT knower FROM friends WHERE knowee = 'James'
  UNION
  SELECT knowee FROM friends WHERE knower = 'James'
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we want to know how big the group is, we&#8217;ll have to nest this <em>again</em> as a subquery:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT COUNT(*) FROM (
  SELECT knower FROM friends
  WHERE knowee IN (
    SELECT knower FROM friends WHERE knowee = 'James'
    UNION
    SELECT knowee FROM friends WHERE knower = 'James'
  )
  UNION
  SELECT knowee FROM friends
  WHERE knower IN (
    SELECT knower FROM friends WHERE knowee = 'James'
    UNION
    SELECT knowee FROM friends WHERE knower = 'James'
  )
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can imagine that there must be better ways of doing this. Remember this example when you&#8217;ll learn about graph databases&#8230;&#8203;</p>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>↑ Up: <a href="index.html">Data Management</a> | Next: <a href="_nosql_an_introduction.html">NoSQL: an introduction</a> →</p>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-11-24 09:35:28 +0100
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>